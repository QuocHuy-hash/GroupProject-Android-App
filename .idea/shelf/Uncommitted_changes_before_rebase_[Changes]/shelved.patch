Index: app/src/main/java/com/example/duan1/EditAccount.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.duan1;\r\n\r\nimport android.Manifest;\r\nimport android.app.Activity;\r\nimport android.app.ProgressDialog;\r\nimport android.content.Intent;\r\nimport android.content.pm.PackageManager;\r\nimport android.graphics.Bitmap;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\nimport android.provider.MediaStore;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\nimport android.widget.RelativeLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport androidx.activity.result.ActivityResult;\r\nimport androidx.activity.result.ActivityResultCallback;\r\nimport androidx.activity.result.ActivityResultLauncher;\r\nimport androidx.activity.result.contract.ActivityResultContracts;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport com.example.duan1.model.Users;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.OnFailureListener;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\nimport com.google.firebase.storage.FirebaseStorage;\r\nimport com.google.firebase.storage.StorageReference;\r\nimport com.google.firebase.storage.UploadTask;\r\nimport com.gun0912.tedpermission.PermissionListener;\r\nimport com.gun0912.tedpermission.normal.TedPermission;\r\nimport com.squareup.picasso.Picasso;\r\n\r\nimport java.io.ByteArrayOutputStream;\r\nimport java.io.IOException;\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.List;\r\n\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\n\r\npublic class EditAccount extends AppCompatActivity {\r\n\r\n    private static final int MY_REQUEST_CODE = 12;\r\n\r\n    private TextView tvName, tvSdt, tvEmail, tvLocation, tvCCCD, tvPassword, tvSex, tvDateOfBirth\r\n            , tvHoaDon;\r\n    private CircleImageView imgImage;\r\n    private RelativeLayout imgAvatar;\r\n    private Button imgName;\r\n    private ImageButton btnBack;\r\n    private Bitmap bitmapselect;\r\n    private String strImage = \" \";\r\n    FirebaseAuth auth;\r\n    FirebaseUser user;\r\n    ProgressDialog progressDialog;\r\n\r\n\r\n    private ActivityResultLauncher<Intent> mActivityResultLauncher = registerForActivityResult(\r\n            new ActivityResultContracts.StartActivityForResult(),\r\n            new ActivityResultCallback<ActivityResult>() {\r\n                @Override\r\n                public void onActivityResult(ActivityResult result) {\r\n\r\n                    if(result.getResultCode()== Activity.RESULT_OK){\r\n                        //there are no request codes\r\n                        Intent data = result.getData();\r\n                        if(data == null){\r\n                            return;\r\n                        }\r\n                        Uri uri = data.getData();\r\n                        try {\r\n                            Calendar calendar = Calendar.getInstance();\r\n\r\n                            bitmapselect = MediaStore.Images.Media.getBitmap(getContentResolver(),uri);\r\n\r\n                            FirebaseStorage storage = FirebaseStorage.getInstance();\r\n                            StorageReference storageRef = storage.getReference();\r\n                            StorageReference mountainsRef = storageRef.child(\"AvatarUser/image\"+calendar.getTimeInMillis());\r\n                            ByteArrayOutputStream baos = new ByteArrayOutputStream();\r\n                            bitmapselect.compress(Bitmap.CompressFormat.JPEG, 100, baos);\r\n                            byte[] dataImage = baos.toByteArray();\r\n\r\n                            UploadTask uploadTask = mountainsRef.putBytes(dataImage);\r\n                            uploadTask.addOnFailureListener(new OnFailureListener() {\r\n                                @Override\r\n                                public void onFailure(@NonNull Exception exception) {\r\n                                    // Handle unsuccessful uploads\r\n                                    Toast.makeText(EditAccount.this, \"Lỗi cập nhật hình ảnh!\", Toast.LENGTH_SHORT).show();\r\n                                }\r\n                            }).addOnSuccessListener(new OnSuccessListener<UploadTask.TaskSnapshot>() {\r\n                                @Override\r\n                                public void onSuccess(UploadTask.TaskSnapshot taskSnapshot) {\r\n                                    // taskSnapshot.getMetadata() contains file metadata such as size, content-type, etc.\r\n\r\n                                    mountainsRef.getDownloadUrl().addOnSuccessListener(new OnSuccessListener<Uri>() {\r\n                                        @Override\r\n                                        public void onSuccess(Uri uri) {\r\n                                            strImage = String.valueOf(uri);\r\n                                            updateImageUrlRealtimeDatabase();\r\n                                        }\r\n                                    }).addOnFailureListener(new OnFailureListener() {\r\n                                        @Override\r\n                                        public void onFailure(@NonNull Exception exception) {\r\n                                            // Handle any errors\r\n                                            Toast.makeText(EditAccount.this, \"Lỗi tải URL hình ảnh!\", Toast.LENGTH_SHORT).show();\r\n                                        }\r\n                                    });\r\n                                }\r\n                            });\r\n                        }catch (IOException e){\r\n                            e.printStackTrace();\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n    );\r\n    private int count = 0;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_edit_account);\r\n        initUi();\r\n        initClickListener();\r\n    }\r\n\r\n    //ánh xạ\r\n    private void initUi() {\r\n        tvName = findViewById(R.id.tv_name_activity_editaccount);\r\n        tvSdt = findViewById(R.id.tv_sdt_activity_editaccount);\r\n        tvEmail = findViewById(R.id.tv_email_activity_editaccount);\r\n        tvLocation = findViewById(R.id.tv_location_activity_editaccount);\r\n        tvCCCD = findViewById(R.id.tv_cccd_activity_editaccount);\r\n        tvPassword = findViewById(R.id.tv_password_activity_editaccount);\r\n        tvSex = findViewById(R.id.tv_sex_activity_editaccount);\r\n        tvDateOfBirth = findViewById(R.id.tv_date_of_birth_activity_editaccount);\r\n        tvHoaDon = findViewById(R.id.tv_xuat_hoa_don_activity_editaccount);\r\n        imgAvatar = findViewById(R.id.img_avatar_activity_editaccount);\r\n        imgImage = findViewById(R.id.img_image);\r\n        imgName = findViewById(R.id.img_name);\r\n        btnBack = findViewById(R.id.imgbtn_back);\r\n\r\n        auth = FirebaseAuth.getInstance();\r\n        user = auth.getCurrentUser();\r\n\r\n        progressDialog = new ProgressDialog(this);\r\n    }\r\n\r\n    //sự kiện click\r\n    private void initClickListener() {\r\n        imgAvatar.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                progressDialog.setTitle(\"Đang tải ảnh...\");\r\n                progressDialog.show();\r\n                requestPermissionsimage();\r\n            }\r\n        });\r\n\r\n\r\n        imgName.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                progressDialog.setTitle(\"Xin chờ!...\");\r\n                progressDialog.show();\r\n                updateNameRealtimeDatabase();\r\n            }\r\n        });\r\n\r\n        btnBack.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                finish();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    private String checkname(String s){\r\n\r\n        if (s.isEmpty()){\r\n            return null;\r\n        }\r\n        String name = \"\";\r\n        if (s.length() > 20){\r\n            for (String s1: s.split(\"\")){\r\n                name+=s1;\r\n                if (name.length() == 30){\r\n                    break;\r\n                }\r\n            };\r\n        }\r\n\r\n        return name+\"...\";\r\n    }\r\n\r\n    private void getDataUser(){\r\n        FirebaseAuth auth = FirebaseAuth.getInstance();\r\n        FirebaseUser user = auth.getCurrentUser();\r\n        String email = user.getEmail();\r\n        List<Users> mListUser = new ArrayList<>();\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference(\"Users\");\r\n        myRef.addValueEventListener(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                mListUser.clear();\r\n                for (DataSnapshot snapshot1 : snapshot.getChildren()){\r\n                    Users user = snapshot1.getValue(Users.class);\r\n                    mListUser.add(user);\r\n                }\r\n                for (int i = 0; i < mListUser.size(); i++){\r\n                    if (mListUser.get(i).getEmail().equals(email)){\r\n                        if (mListUser.get(i).getName().length() > 30){\r\n                            tvName.setText(checkname(mListUser.get(i).getName()));\r\n                        }else{\r\n                            tvName.setText(mListUser.get(i).getName());\r\n                        }\r\n                        String strImage = mListUser.get(i).getImage().trim();\r\n                        if (strImage.isEmpty()){\r\n                            return;\r\n                        }\r\n                        Picasso.with(EditAccount.this)\r\n                                .load(strImage)\r\n                                .placeholder(R.drawable.user_icon)\r\n                                .error(R.drawable.user_icon)\r\n                                .into(imgImage);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    private void openGallery() {\r\n        Intent intent = new Intent();\r\n        intent.setType(\"image/*\");\r\n        intent.setAction(Intent.ACTION_GET_CONTENT);\r\n        mActivityResultLauncher.launch(Intent.createChooser(intent, \"Select picture\"));\r\n    }\r\n\r\n    @Override\r\n    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) {\r\n        super.onRequestPermissionsResult(requestCode, permissions, grantResults);\r\n        if(requestCode == MY_REQUEST_CODE){\r\n            if(grantResults.length > 0 && grantResults[0] == PackageManager.PERMISSION_GRANTED){\r\n                openGallery();\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    private void requestPermissionsimage() {\r\n        PermissionListener permissionlistener = new PermissionListener() {\r\n            @Override\r\n            public void onPermissionGranted() {\r\n                openGallery();\r\n            }\r\n\r\n            @Override\r\n            public void onPermissionDenied(List<String> deniedPermissions) {\r\n                Toast.makeText(EditAccount.this, \"Đã từ chối quyền truy cập\\n\" + deniedPermissions.toString(), Toast.LENGTH_SHORT).show();\r\n            }\r\n        };\r\n        TedPermission.create()\r\n                .setPermissionListener(permissionlistener)\r\n                .setDeniedMessage(\"If you reject permission,you can not use this service\\n\\nPlease turn on permissions at [Setting] > [Permission]\")\r\n                .setPermissions(Manifest.permission.CAMERA, Manifest.permission.READ_EXTERNAL_STORAGE, Manifest.permission.WRITE_EXTERNAL_STORAGE)\r\n                .check();\r\n    }\r\n\r\n    private void updateImageUrlRealtimeDatabase() {\r\n        List<Users> listUser = new ArrayList<>();\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference(\"Users\");\r\n\r\n        myRef.addValueEventListener(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                listUser.clear();\r\n                for (DataSnapshot snapshot1 : snapshot.getChildren()){\r\n                    Users user = snapshot1.getValue(Users.class);\r\n                    listUser.add(user);\r\n                }\r\n\r\n                String email = user.getEmail();\r\n                for (int i = 0; i< listUser.size(); i++){\r\n                    if (listUser.get(i).getEmail().equals(email)){\r\n                        count = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n                Toast.makeText(EditAccount.this, \"Lỗi cập nhật hình ảnh!\", Toast.LENGTH_SHORT).show();\r\n            }\r\n\r\n\r\n        });\r\n\r\n        Handler handler = new Handler();\r\n        handler.postDelayed(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                UpdateImageUrl(count, listUser);\r\n                progressDialog.dismiss();\r\n            }\r\n        },2000);\r\n\r\n\r\n    }\r\n\r\n    private void UpdateImageUrl(int id, List<Users> users) {\r\n        if (users.size() == 0 || id == 0){\r\n            finish();\r\n        }\r\n        String email = user.getEmail();\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference();\r\n        if (users.get(id).getEmail().equals(email)){\r\n            myRef.child(\"Users\").child(users.get(id).getId()+\"\").child(\"image\").setValue(strImage)\r\n                    .addOnCompleteListener(new OnCompleteListener<Void>() {\r\n                @Override\r\n                public void onComplete(@NonNull Task<Void> task) {\r\n                    Toast.makeText(EditAccount.this, \"Đã xong!\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private void updateNameRealtimeDatabase() {\r\n        List<Users> listUser = new ArrayList<>();\r\n\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference();\r\n\r\n        myRef.child(\"Users\").addValueEventListener(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                listUser.clear();\r\n                for (DataSnapshot snapshot1 : snapshot.getChildren()){\r\n                    Users user = snapshot1.getValue(Users.class);\r\n\r\n                    listUser.add(user);\r\n                }\r\n                String email = user.getEmail();\r\n                for (int i = 0; i< listUser.size(); i++){\r\n                    if (listUser.get(i).getEmail().equals(email)){\r\n                        count = i;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n                Toast.makeText(EditAccount.this, \"Lỗi cập nhật tên!\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n\r\n        Handler handler = new Handler();\r\n        handler.postDelayed(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                UpdateName(count, listUser);\r\n                progressDialog.dismiss();\r\n            }\r\n        },2000);\r\n\r\n    }\r\n\r\n    private void UpdateName(int id, List<Users> users){\r\n        if (users.size() == 0){\r\n            finish();\r\n        }\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference();\r\n        String email = user.getEmail();\r\n        String name = tvName.getText().toString().trim();\r\n        if (users.get(id).getEmail().equals(email)){\r\n            myRef.child(\"Users\").child(users.get(id).getId()+\"\").child(\"name\").setValue(name)\r\n                    .addOnCompleteListener(new OnCompleteListener<Void>() {\r\n                @Override\r\n                public void onComplete(@NonNull Task<Void> task) {\r\n                    Toast.makeText(EditAccount.this, \"Đã xong!\", Toast.LENGTH_SHORT).show();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        getDataUser();\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/duan1/EditAccount.java b/app/src/main/java/com/example/duan1/EditAccount.java
--- a/app/src/main/java/com/example/duan1/EditAccount.java	(revision b92f36320a6a42b3f731d4598ab9b06018460d63)
+++ b/app/src/main/java/com/example/duan1/EditAccount.java	(date 1669992748059)
@@ -2,15 +2,21 @@
 
 import android.Manifest;
 import android.app.Activity;
+import android.app.Dialog;
 import android.app.ProgressDialog;
 import android.content.Intent;
 import android.content.pm.PackageManager;
 import android.graphics.Bitmap;
+import android.graphics.Color;
+import android.graphics.drawable.ColorDrawable;
 import android.net.Uri;
 import android.os.Bundle;
 import android.os.Handler;
 import android.provider.MediaStore;
+import android.view.Gravity;
 import android.view.View;
+import android.view.Window;
+import android.view.WindowManager;
 import android.widget.Button;
 import android.widget.ImageButton;
 import android.widget.RelativeLayout;
@@ -22,6 +28,7 @@
 import androidx.activity.result.ActivityResultLauncher;
 import androidx.activity.result.contract.ActivityResultContracts;
 import androidx.annotation.NonNull;
+import androidx.annotation.Nullable;
 import androidx.appcompat.app.AppCompatActivity;
 
 import com.example.duan1.model.Users;
@@ -63,10 +70,10 @@
     private ImageButton btnBack;
     private Bitmap bitmapselect;
     private String strImage = " ";
-    FirebaseAuth auth;
-    FirebaseUser user;
-    ProgressDialog progressDialog;
-
+    private FirebaseAuth auth;
+    private FirebaseUser user;
+    private ProgressDialog progressDialog;
+    private List<Users> mListUser;
 
     private ActivityResultLauncher<Intent> mActivityResultLauncher = registerForActivityResult(
             new ActivityResultContracts.StartActivityForResult(),
@@ -86,9 +93,12 @@
 
                             bitmapselect = MediaStore.Images.Media.getBitmap(getContentResolver(),uri);
 
+                            progressDialog.setTitle("Đang tải ảnh lên...!");
+                            progressDialog.show();
+
                             FirebaseStorage storage = FirebaseStorage.getInstance();
                             StorageReference storageRef = storage.getReference();
-                            StorageReference mountainsRef = storageRef.child("AvatarUser/image"+calendar.getTimeInMillis());
+                            StorageReference mountainsRef = storageRef.child("AvatarUser/"+user.getEmail()+"/image"+calendar.getTimeInMillis());
                             ByteArrayOutputStream baos = new ByteArrayOutputStream();
                             bitmapselect.compress(Bitmap.CompressFormat.JPEG, 100, baos);
                             byte[] dataImage = baos.toByteArray();
@@ -98,6 +108,7 @@
                                 @Override
                                 public void onFailure(@NonNull Exception exception) {
                                     // Handle unsuccessful uploads
+                                    progressDialog.dismiss();
                                     Toast.makeText(EditAccount.this, "Lỗi cập nhật hình ảnh!", Toast.LENGTH_SHORT).show();
                                 }
                             }).addOnSuccessListener(new OnSuccessListener<UploadTask.TaskSnapshot>() {
@@ -109,32 +120,46 @@
                                         @Override
                                         public void onSuccess(Uri uri) {
                                             strImage = String.valueOf(uri);
-                                            updateImageUrlRealtimeDatabase();
+                                            UpdateImageUrl();
+                                            progressDialog.dismiss();
                                         }
                                     }).addOnFailureListener(new OnFailureListener() {
                                         @Override
                                         public void onFailure(@NonNull Exception exception) {
                                             // Handle any errors
+                                            progressDialog.dismiss();
                                             Toast.makeText(EditAccount.this, "Lỗi tải URL hình ảnh!", Toast.LENGTH_SHORT).show();
                                         }
                                     });
                                 }
                             });
+
+
                         }catch (IOException e){
                             e.printStackTrace();
+                            progressDialog.dismiss();
                         }
                     }
                 }
             }
     );
-    private int count = 0;
+
 
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_edit_account);
         initUi();
-        initClickListener();
+        getDataUser();
+        progressDialog.show();
+        new Handler().postDelayed(new Runnable() {
+            @Override
+            public void run() {
+                initClickListener();
+                progressDialog.dismiss();
+            }
+        }, 500);
+
     }
 
     //ánh xạ
@@ -164,8 +189,6 @@
         imgAvatar.setOnClickListener(new View.OnClickListener() {
             @Override
             public void onClick(View view) {
-                progressDialog.setTitle("Đang tải ảnh...");
-                progressDialog.show();
                 requestPermissionsimage();
             }
         });
@@ -176,7 +199,8 @@
             public void onClick(View view) {
                 progressDialog.setTitle("Xin chờ!...");
                 progressDialog.show();
-                updateNameRealtimeDatabase();
+                UpdateName();
+                progressDialog.dismiss();
             }
         });
 
@@ -187,31 +211,36 @@
             }
         });
 
-    }
-
-    private String checkname(String s){
+        tvSdt.setOnClickListener(new View.OnClickListener() {
+            @Override
+            public void onClick(View view) {
+                setSdt();
+            }
+        });
 
-        if (s.isEmpty()){
-            return null;
-        }
-        String name = "";
+    }
+
+    @Nullable
+    private String checkname(@NonNull String s){
+        String name1 = "";
         if (s.length() > 20){
             for (String s1: s.split("")){
-                name+=s1;
-                if (name.length() == 30){
+                name1+=s1;
+                if (name1.length() == 20){
                     break;
                 }
-            };
+            }
+            return name1+"...";
         }
 
-        return name+"...";
+        return s;
     }
 
     private void getDataUser(){
         FirebaseAuth auth = FirebaseAuth.getInstance();
         FirebaseUser user = auth.getCurrentUser();
         String email = user.getEmail();
-        List<Users> mListUser = new ArrayList<>();
+        mListUser = new ArrayList<>();
         FirebaseDatabase database = FirebaseDatabase.getInstance();
         DatabaseReference myRef = database.getReference("Users");
         myRef.addValueEventListener(new ValueEventListener() {
@@ -221,15 +250,9 @@
                 for (DataSnapshot snapshot1 : snapshot.getChildren()){
                     Users user = snapshot1.getValue(Users.class);
                     mListUser.add(user);
-                }
-                for (int i = 0; i < mListUser.size(); i++){
-                    if (mListUser.get(i).getEmail().equals(email)){
-                        if (mListUser.get(i).getName().length() > 30){
-                            tvName.setText(checkname(mListUser.get(i).getName()));
-                        }else{
-                            tvName.setText(mListUser.get(i).getName());
-                        }
-                        String strImage = mListUser.get(i).getImage().trim();
+                    if (user.getEmail().equals(email)){
+                        tvName.setText(checkname(user.getName()));
+                        String strImage = user.getImage().trim();
                         if (strImage.isEmpty()){
                             return;
                         }
@@ -255,6 +278,7 @@
         intent.setType("image/*");
         intent.setAction(Intent.ACTION_GET_CONTENT);
         mActivityResultLauncher.launch(Intent.createChooser(intent, "Select picture"));
+
     }
 
     @Override
@@ -287,132 +311,71 @@
                 .check();
     }
 
-    private void updateImageUrlRealtimeDatabase() {
-        List<Users> listUser = new ArrayList<>();
-        FirebaseDatabase database = FirebaseDatabase.getInstance();
-        DatabaseReference myRef = database.getReference("Users");
-
-        myRef.addValueEventListener(new ValueEventListener() {
-            @Override
-            public void onDataChange(@NonNull DataSnapshot snapshot) {
-                listUser.clear();
-                for (DataSnapshot snapshot1 : snapshot.getChildren()){
-                    Users user = snapshot1.getValue(Users.class);
-                    listUser.add(user);
-                }
-
-                String email = user.getEmail();
-                for (int i = 0; i< listUser.size(); i++){
-                    if (listUser.get(i).getEmail().equals(email)){
-                        count = i;
-                        break;
-                    }
-                }
+    private void UpdateImageUrl() {
+        if (mListUser.size() == 0){
+            return;
+        }
+        String email = user.getEmail();
+        int index = -1;
+        for (int i = 0; i < mListUser.size(); i++){
+            if (mListUser.get(i).getEmail().equals(email)){
+                index = i;
             }
-
-            @Override
-            public void onCancelled(@NonNull DatabaseError error) {
-                Toast.makeText(EditAccount.this, "Lỗi cập nhật hình ảnh!", Toast.LENGTH_SHORT).show();
-            }
-
-
-        });
-
-        Handler handler = new Handler();
-        handler.postDelayed(new Runnable() {
-            @Override
-            public void run() {
-                UpdateImageUrl(count, listUser);
-                progressDialog.dismiss();
-            }
-        },2000);
-
-
-    }
-
-    private void UpdateImageUrl(int id, List<Users> users) {
-        if (users.size() == 0 || id == 0){
-            finish();
         }
-        String email = user.getEmail();
         FirebaseDatabase database = FirebaseDatabase.getInstance();
         DatabaseReference myRef = database.getReference();
-        if (users.get(id).getEmail().equals(email)){
-            myRef.child("Users").child(users.get(id).getId()+"").child("image").setValue(strImage)
-                    .addOnCompleteListener(new OnCompleteListener<Void>() {
-                @Override
-                public void onComplete(@NonNull Task<Void> task) {
-                    Toast.makeText(EditAccount.this, "Đã xong!", Toast.LENGTH_SHORT).show();
-                }
-            });
-        }
-    }
-
-    private void updateNameRealtimeDatabase() {
-        List<Users> listUser = new ArrayList<>();
-
-        FirebaseDatabase database = FirebaseDatabase.getInstance();
-        DatabaseReference myRef = database.getReference();
-
-        myRef.child("Users").addValueEventListener(new ValueEventListener() {
-            @Override
-            public void onDataChange(@NonNull DataSnapshot snapshot) {
-                listUser.clear();
-                for (DataSnapshot snapshot1 : snapshot.getChildren()){
-                    Users user = snapshot1.getValue(Users.class);
-
-                    listUser.add(user);
-                }
-                String email = user.getEmail();
-                for (int i = 0; i< listUser.size(); i++){
-                    if (listUser.get(i).getEmail().equals(email)){
-                        count = i;
-                        break;
-                    }
-                }
-
-            }
-
-            @Override
-            public void onCancelled(@NonNull DatabaseError error) {
-                Toast.makeText(EditAccount.this, "Lỗi cập nhật tên!", Toast.LENGTH_SHORT).show();
-            }
-        });
-
-
-        Handler handler = new Handler();
-        handler.postDelayed(new Runnable() {
-            @Override
-            public void run() {
-                UpdateName(count, listUser);
-                progressDialog.dismiss();
-            }
-        },2000);
+        myRef.child("Users").child(mListUser.get(index).getId()+"").child("image").setValue(strImage)
+                .addOnCompleteListener(new OnCompleteListener<Void>() {
+                    @Override
+                    public void onComplete(@NonNull Task<Void> task) {
+                        Toast.makeText(EditAccount.this, "Đã xong!", Toast.LENGTH_SHORT).show();
+                    }
+                });
 
     }
 
-    private void UpdateName(int id, List<Users> users){
-        if (users.size() == 0){
+    private void UpdateName(){
+        if (mListUser.size() == 0){
             finish();
         }
-        FirebaseDatabase database = FirebaseDatabase.getInstance();
-        DatabaseReference myRef = database.getReference();
         String email = user.getEmail();
         String name = tvName.getText().toString().trim();
-        if (users.get(id).getEmail().equals(email)){
-            myRef.child("Users").child(users.get(id).getId()+"").child("name").setValue(name)
-                    .addOnCompleteListener(new OnCompleteListener<Void>() {
-                @Override
-                public void onComplete(@NonNull Task<Void> task) {
-                    Toast.makeText(EditAccount.this, "Đã xong!", Toast.LENGTH_SHORT).show();
-                }
-            });
-        }
-    }
+        int index = -1;
+        for (int i = 0; i < mListUser.size(); i++){
+            if (mListUser.get(i).getEmail().equals(email)){
+                index = i;
+            }
+        }
+        FirebaseDatabase database = FirebaseDatabase.getInstance();
+        DatabaseReference myRef = database.getReference();
+        myRef.child("Users").child(mListUser.get(index).getId()+"").child("name").setValue(name)
+                .addOnCompleteListener(new OnCompleteListener<Void>() {
+                    @Override
+                    public void onComplete(@NonNull Task<Void> task) {
+                        Toast.makeText(EditAccount.this, "Đã xong!", Toast.LENGTH_SHORT).show();
+                    }
+                });
+
+    }
+
+    private void setSdt() {
+        final Dialog dialog = new Dialog(EditAccount.this);
+        dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
+        dialog.setContentView(R.layout.dialog_edit_account);
+
+        Window window = dialog.getWindow();
+        if(window == null){
+            return;
+        }
+        dialog.setCancelable(false);
 
-    @Override
-    protected void onStart() {
-        super.onStart();
-        getDataUser();
+        window.setLayout(WindowManager.LayoutParams.MATCH_PARENT, WindowManager.LayoutParams.WRAP_CONTENT);
+        window.setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT));
+
+        WindowManager.LayoutParams windowAttributes = window.getAttributes();
+        windowAttributes.gravity = Gravity.CENTER;
+        window.setAttributes(windowAttributes);
+
+        //anh xa
     }
 }
\ No newline at end of file
Index: app/src/main/java/com/example/duan1/model/Users.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.duan1.model;\r\n\r\nimport com.google.firebase.database.Exclude;\r\n\r\nimport java.io.Serializable;\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\npublic class Users implements Serializable {\r\n\r\n    private int id;\r\n    private String name;\r\n    private String email;\r\n    private String sdt;\r\n    private String image;\r\n    private String password;\r\n\r\n    public Users() {\r\n    }\r\n\r\n    public Users(int id, String name, String email, String sdt, String image, String password) {\r\n        this.id = id;\r\n        this.name = name;\r\n        this.email = email;\r\n        this.sdt = sdt;\r\n        this.image = image;\r\n        this.password = password;\r\n    }\r\n\r\n    public int getId() {\r\n        return id;\r\n    }\r\n\r\n    public void setId(int id) {\r\n        this.id = id;\r\n    }\r\n\r\n    public String getName() {\r\n        return name;\r\n    }\r\n\r\n    public void setName(String name) {\r\n        this.name = name;\r\n    }\r\n\r\n    public String getEmail() {\r\n        return email;\r\n    }\r\n\r\n    public void setEmail(String email) {\r\n        this.email = email;\r\n    }\r\n\r\n    public String getSdt() {\r\n        return sdt;\r\n    }\r\n\r\n    public void setSdt(String sdt) {\r\n        this.sdt = sdt;\r\n    }\r\n\r\n    public String getImage() {\r\n        return image;\r\n    }\r\n\r\n    public void setImage(String image) {\r\n        this.image = image;\r\n    }\r\n\r\n    public String getPassword() {\r\n        return password;\r\n    }\r\n\r\n    public void setPassword(String password) {\r\n        this.password = password;\r\n    }\r\n\r\n    @Exclude\r\n    public Map<String, Object> toMap() {\r\n        HashMap<String, Object> result = new HashMap<>();\r\n        result.put(\"id\", id);\r\n        result.put(\"name\", name);\r\n        result.put(\"email\", email);\r\n        result.put(\"sdt\", sdt);\r\n        result.put(\"image\", image);\r\n        result.put(\"password\", password);\r\n\r\n        return result;\r\n    }\r\n\r\n    @Exclude\r\n    public Map<String, Object> toMapImage() {\r\n        HashMap<String, Object> result = new HashMap<>();\r\n        result.put(\"id\", id);\r\n        result.put(\"name\", name);\r\n        result.put(\"email\", email);\r\n        result.put(\"sdt\", sdt);\r\n        result.put(\"image\", image);\r\n        result.put(\"password\", password);\r\n\r\n        return result;\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/duan1/model/Users.java b/app/src/main/java/com/example/duan1/model/Users.java
--- a/app/src/main/java/com/example/duan1/model/Users.java	(revision b92f36320a6a42b3f731d4598ab9b06018460d63)
+++ b/app/src/main/java/com/example/duan1/model/Users.java	(date 1669990089182)
@@ -14,17 +14,27 @@
     private String sdt;
     private String image;
     private String password;
+    private String sex;
+    private String dateofbirth;
+    private String cccd;
+    private String address;
+
 
     public Users() {
     }
 
-    public Users(int id, String name, String email, String sdt, String image, String password) {
+
+    public Users(int id, String name, String email, String sdt, String image, String password, String sex, String dateofbirth, String cccd, String address) {
         this.id = id;
         this.name = name;
         this.email = email;
         this.sdt = sdt;
         this.image = image;
         this.password = password;
+        this.sex = sex;
+        this.dateofbirth = dateofbirth;
+        this.cccd = cccd;
+        this.address = address;
     }
 
     public int getId() {
@@ -75,29 +85,50 @@
         this.password = password;
     }
 
-    @Exclude
-    public Map<String, Object> toMap() {
-        HashMap<String, Object> result = new HashMap<>();
-        result.put("id", id);
-        result.put("name", name);
-        result.put("email", email);
-        result.put("sdt", sdt);
-        result.put("image", image);
-        result.put("password", password);
+    public String getSex() {
+        return sex;
+    }
+
+    public void setSex(String sex) {
+        this.sex = sex;
+    }
 
-        return result;
+    public String getDateofbirth() {
+        return dateofbirth;
     }
 
-    @Exclude
-    public Map<String, Object> toMapImage() {
-        HashMap<String, Object> result = new HashMap<>();
-        result.put("id", id);
-        result.put("name", name);
-        result.put("email", email);
-        result.put("sdt", sdt);
-        result.put("image", image);
-        result.put("password", password);
+    public void setDateofbirth(String dateofbirth) {
+        this.dateofbirth = dateofbirth;
+    }
 
-        return result;
+    public String getCccd() {
+        return cccd;
     }
+
+    public void setCccd(String cccd) {
+        this.cccd = cccd;
+    }
+
+    public String getAddress() {
+        return address;
+    }
+
+    public void setAddress(String address) {
+        this.address = address;
+    }
+
+    //    @Exclude
+//    public Map<String, Object> toMap() {
+//        HashMap<String, Object> result = new HashMap<>();
+//        result.put("id", id);
+//        result.put("name", name);
+//        result.put("email", email);
+//        result.put("sdt", sdt);
+//        result.put("image", image);
+//        result.put("password", password);
+//
+//        return result;
+//    }
+
+
 }
Index: app/src/main/java/com/example/duan1/Account.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.duan1;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageButton;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.duan1.model.Users;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\nimport com.squareup.picasso.Picasso;\r\n\r\nimport java.io.Serializable;\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\n\r\npublic class Account extends AppCompatActivity {\r\n\r\n    private TextView tvUsernameTitle, tvUsernameContent, tvFollowers, tvWatching, tvEditAccount\r\n            , tvJudge, tvParticipationDate, tvLocation, tvFeedbackMessage, tvBelieve;\r\n    private ImageView imgShare;\r\n    private CircleImageView imgAvatar;\r\n    private Button btnPost, btnJobApplication;\r\n    private ImageButton btnBack;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_account);\r\n        initUi();\r\n\r\n        initClickListener();\r\n\r\n        getProfileUser();\r\n    }\r\n\r\n    //Ánh xạ\r\n    private void initUi() {\r\n        tvUsernameTitle = findViewById(R.id.username_activity_account);\r\n        tvUsernameContent = findViewById(R.id.username_content_activity_account);\r\n        tvFollowers = findViewById(R.id.tv_followers_activity_account);\r\n        tvWatching = findViewById(R.id.tv_watching_activity_account);\r\n        tvEditAccount = findViewById(R.id.tv_edit_account_activity_account);\r\n        tvJudge = findViewById(R.id.tv_judge_activity_account);\r\n        tvParticipationDate = findViewById(R.id.tv_participation_date_activity_account);\r\n        tvLocation = findViewById(R.id.tv_location_activity_account);\r\n        tvFeedbackMessage = findViewById(R.id.tv_feedback_message_activity_account);\r\n        tvBelieve = findViewById(R.id.tv_believe_activity_account);\r\n        imgAvatar = findViewById(R.id.img_avatar_activity_account);\r\n        imgShare = findViewById(R.id.img_share_acvitity_account);\r\n        btnPost = findViewById(R.id.btn_post_news);\r\n        btnJobApplication = findViewById(R.id.btn_job_application);\r\n        btnBack = findViewById(R.id.btn_back_activity_account);\r\n    }\r\n\r\n    //sự kiện click\r\n    private void initClickListener() {\r\n        tvEditAccount.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                Intent intent = new Intent(Account.this, EditAccount.class);\r\n                startActivity(intent);\r\n            }\r\n        });\r\n\r\n        btnBack.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                finish();\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    private void getProfileUser() {\r\n        FirebaseAuth auth = FirebaseAuth.getInstance();\r\n        FirebaseUser user = auth.getCurrentUser();\r\n        String email = user.getEmail();\r\n        List<Users> mListUser = new ArrayList<>();\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference(\"Users\");\r\n        myRef.addValueEventListener(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                mListUser.clear();\r\n                for (DataSnapshot snapshot1 : snapshot.getChildren()){\r\n                    Users user = snapshot1.getValue(Users.class);\r\n                    mListUser.add(user);\r\n                }\r\n                for (int i = 0; i < mListUser.size(); i++){\r\n                    if (mListUser.get(i).getEmail().equals(email)){\r\n                        if (mListUser.get(i).getName().length() > 30){\r\n                            tvUsernameTitle.setText(checkname(mListUser.get(i).getName()));\r\n                            tvUsernameContent.setText(checkname(mListUser.get(i).getName()));\r\n                        }else{\r\n                            tvUsernameTitle.setText(mListUser.get(i).getName());\r\n                            tvUsernameContent.setText(mListUser.get(i).getName());\r\n                        }\r\n                        String strImage = mListUser.get(i).getImage().trim();\r\n                        if (strImage.isEmpty()){\r\n                            return;\r\n                        }\r\n                        Picasso.with(Account.this)\r\n                                .load(strImage)\r\n                                .placeholder(R.drawable.user_icon)\r\n                                .error(R.drawable.user_icon)\r\n                                .into(imgAvatar);\r\n\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n\r\n    private String checkname(String s){\r\n\r\n        if (s.isEmpty()){\r\n            return null;\r\n        }\r\n        String name = \"\";\r\n        if (s.length() > 20){\r\n            for (String s1: s.split(\"\")){\r\n                name+=s1;\r\n                if (name.length() == 30){\r\n                    break;\r\n                }\r\n            };\r\n        }\r\n\r\n        return name+\"...\";\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/duan1/Account.java b/app/src/main/java/com/example/duan1/Account.java
--- a/app/src/main/java/com/example/duan1/Account.java	(revision b92f36320a6a42b3f731d4598ab9b06018460d63)
+++ b/app/src/main/java/com/example/duan1/Account.java	(date 1669992365017)
@@ -3,8 +3,10 @@
 import androidx.annotation.NonNull;
 import androidx.appcompat.app.AppCompatActivity;
 
+import android.app.ProgressDialog;
 import android.content.Intent;
 import android.os.Bundle;
+import android.os.Handler;
 import android.view.View;
 import android.widget.Button;
 import android.widget.ImageButton;
@@ -13,6 +15,13 @@
 import android.widget.Toast;
 
 import com.example.duan1.model.Users;
+import com.facebook.AccessToken;
+import com.facebook.GraphRequest;
+import com.facebook.GraphResponse;
+import com.google.android.gms.auth.api.signin.GoogleSignIn;
+import com.google.android.gms.auth.api.signin.GoogleSignInAccount;
+import com.google.android.gms.auth.api.signin.GoogleSignInClient;
+import com.google.android.gms.auth.api.signin.GoogleSignInOptions;
 import com.google.firebase.auth.FirebaseAuth;
 import com.google.firebase.auth.FirebaseUser;
 import com.google.firebase.database.DataSnapshot;
@@ -22,6 +31,9 @@
 import com.google.firebase.database.ValueEventListener;
 import com.squareup.picasso.Picasso;
 
+import org.json.JSONException;
+import org.json.JSONObject;
+
 import java.io.Serializable;
 import java.util.ArrayList;
 import java.util.List;
@@ -30,27 +42,50 @@
 
 public class Account extends AppCompatActivity {
 
-    private TextView tvUsernameTitle, tvUsernameContent, tvFollowers, tvWatching, tvEditAccount
+    private TextView tvUsernameContent, tvFollowers, tvWatching, tvEditAccount
             , tvJudge, tvParticipationDate, tvLocation, tvFeedbackMessage, tvBelieve;
     private ImageView imgShare;
     private CircleImageView imgAvatar;
     private Button btnPost, btnJobApplication;
     private ImageButton btnBack;
+    private ProgressDialog progressDialog;
+    private GoogleSignInClient mGoogleSignInClient;
+    private GoogleSignInOptions gso;
+    GoogleSignInAccount acct;
+    private FirebaseAuth mAuth;
+    private FirebaseUser currentUser;
 
     @Override
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_account);
         initUi();
+        AccessToken accessToken = AccessToken.getCurrentAccessToken();
+        boolean isLoggedIn = accessToken != null && !accessToken.isExpired();
+        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN).requestEmail().build();
+        mGoogleSignInClient = GoogleSignIn.getClient(this, gso);
+        acct = GoogleSignIn.getLastSignedInAccount(this);
 
-        initClickListener();
-
-        getProfileUser();
+            if (currentUser != null){
+                getProfileUser();
+            }else if (isLoggedIn){
+                getProfileUserFB();
+            }else if (acct != null){
+                getProfileUserGoogle();
+            }
+
+            //code click listener
+            new Handler().postDelayed(new Runnable() {
+                @Override
+                public void run() {
+                    initClickListener();
+                }
+            },500);
+
     }
 
     //Ánh xạ
     private void initUi() {
-        tvUsernameTitle = findViewById(R.id.username_activity_account);
         tvUsernameContent = findViewById(R.id.username_content_activity_account);
         tvFollowers = findViewById(R.id.tv_followers_activity_account);
         tvWatching = findViewById(R.id.tv_watching_activity_account);
@@ -65,6 +100,10 @@
         btnPost = findViewById(R.id.btn_post_news);
         btnJobApplication = findViewById(R.id.btn_job_application);
         btnBack = findViewById(R.id.btn_back_activity_account);
+
+        progressDialog = new ProgressDialog(this);
+        mAuth = FirebaseAuth.getInstance();
+        currentUser = mAuth.getCurrentUser();
     }
 
     //sự kiện click
@@ -72,8 +111,14 @@
         tvEditAccount.setOnClickListener(new View.OnClickListener() {
             @Override
             public void onClick(View view) {
-                Intent intent = new Intent(Account.this, EditAccount.class);
-                startActivity(intent);
+                if (currentUser != null){
+                    Intent intent = new Intent(Account.this, EditAccount.class);
+                    intent.putExtra("email", currentUser.getEmail());
+                    startActivity(intent);
+                }else{
+                    Toast.makeText(Account.this, "Đăng nhập bằng tài khoản chợ tốt để chỉnh sửa thông tin!", Toast.LENGTH_SHORT).show();
+                }
+
             }
         });
 
@@ -85,7 +130,6 @@
         });
     }
 
-
     private void getProfileUser() {
         FirebaseAuth auth = FirebaseAuth.getInstance();
         FirebaseUser user = auth.getCurrentUser();
@@ -103,13 +147,7 @@
                 }
                 for (int i = 0; i < mListUser.size(); i++){
                     if (mListUser.get(i).getEmail().equals(email)){
-                        if (mListUser.get(i).getName().length() > 30){
-                            tvUsernameTitle.setText(checkname(mListUser.get(i).getName()));
-                            tvUsernameContent.setText(checkname(mListUser.get(i).getName()));
-                        }else{
-                            tvUsernameTitle.setText(mListUser.get(i).getName());
-                            tvUsernameContent.setText(mListUser.get(i).getName());
-                        }
+                        tvUsernameContent.setText(checkname(mListUser.get(i).getName()));
                         String strImage = mListUser.get(i).getImage().trim();
                         if (strImage.isEmpty()){
                             return;
@@ -133,22 +171,59 @@
 
     }
 
-
     private String checkname(String s){
-
-        if (s.isEmpty()){
-            return null;
-        }
         String name = "";
         if (s.length() > 20){
             for (String s1: s.split("")){
                 name+=s1;
-                if (name.length() == 30){
+                if (name.length() == 20){
                     break;
                 }
-            };
-        }
-
-        return name+"...";
+            }
+            return name+"...";
+        }
+
+       return s;
     }
+
+    private void getProfileUserFB() {
+        AccessToken accessToken = AccessToken.getCurrentAccessToken();
+        GraphRequest request = GraphRequest.newMeRequest(
+                accessToken,
+                new GraphRequest.GraphJSONObjectCallback() {
+                    @Override
+                    public void onCompleted(JSONObject object, GraphResponse response) {
+                        try {
+                            String fullName = object.getString("name");
+                            String image = object.getJSONObject("picture").getJSONObject("data").getString("url");
+                            tvUsernameContent.setText(checkname(fullName));
+                            Picasso.with(Account.this)
+                                    .load(image)
+                                    .placeholder(R.drawable.user_icon)
+                                    .error(R.drawable.user_icon)
+                                    .into(imgAvatar);
+                        } catch (JSONException e) {
+                            Toast.makeText(Account.this, "Lỗi tải dữ liệu tk fb: "+e, Toast.LENGTH_SHORT).show();
+                        }
+
+                    }
+                });
+
+        Bundle parameters = new Bundle();
+        parameters.putString("fields", "id,name,link,picture.type(large)");
+        request.setParameters(parameters);
+        request.executeAsync();
+    }
+
+    private void getProfileUserGoogle() {
+        String personName = acct.getDisplayName();
+        String personPhoto = String.valueOf(acct.getPhotoUrl());
+        tvUsernameContent.setText(checkname(personName));
+        Picasso.with(this)
+                .load(personPhoto)
+                .placeholder(R.drawable.user_icon)
+                .error(R.drawable.user_icon)
+                .into(imgAvatar);
+
+    }
 }
\ No newline at end of file
Index: app/src/main/res/layout/activity_account.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".Account\"\r\n    android:orientation=\"vertical\"\r\n    android:background=\"#ECEBEB\"\r\n    >\r\n\r\n    <androidx.appcompat.widget.Toolbar\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"50dp\"\r\n        android:background=\"@color/Orenge\"\r\n\r\n        >\r\n\r\n        <ImageButton\r\n            android:id=\"@+id/btn_back_activity_account\"\r\n            android:layout_width=\"35dp\"\r\n            android:layout_height=\"35dp\"\r\n            android:src=\"@drawable/ic_back_page\"\r\n            android:background=\"@color/trans...\"\r\n\r\n            />\r\n\r\n        <TextView\r\n            android:id=\"@+id/username_activity_account\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:text=\"Username\"\r\n            android:layout_marginLeft=\"30dp\"\r\n            android:textStyle=\"bold\"\r\n            android:textSize=\"18dp\"\r\n            android:textColor=\"@color/black\"\r\n            />\r\n\r\n    </androidx.appcompat.widget.Toolbar>\r\n    <ScrollView\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\">\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\"\r\n            >\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:paddingHorizontal=\"15dp\"\r\n                android:background=\"@color/white\"\r\n                android:paddingVertical=\"20dp\"\r\n                >\r\n\r\n\r\n                    <de.hdodenhof.circleimageview.CircleImageView\r\n                        android:id=\"@+id/img_avatar_activity_account\"\r\n                        android:layout_width=\"100dp\"\r\n                        android:layout_height=\"100dp\"\r\n                        android:layout_gravity=\"center\"\r\n                        android:src=\"@drawable/user_icon\"\r\n                        />\r\n\r\n\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"100dp\"\r\n                    android:layout_gravity=\"center\"\r\n                    android:layout_marginLeft=\"12dp\"\r\n                    android:orientation=\"vertical\"\r\n                    android:gravity=\"center\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/username_content_activity_account\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Username\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"18dp\"\r\n                        android:textStyle=\"bold\"\r\n                        />\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginTop=\"10dp\"\r\n                        >\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/tv_followers_activity_account\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:text=\"0\"\r\n                            android:textStyle=\"bold\"\r\n                            android:textSize=\"14dp\"\r\n                            android:textColor=\"@color/black\"\r\n                            />\r\n\r\n                        <TextView\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:text=\"Người theo dõi\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"12dp\"\r\n                            android:layout_marginLeft=\"5dp\"\r\n                            android:layout_gravity=\"center\"\r\n                            />\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/tv_watching_activity_account\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:text=\"0\"\r\n                            android:textStyle=\"bold\"\r\n                            android:textSize=\"14dp\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:layout_marginLeft=\"15dp\"\r\n                            />\r\n\r\n                        <TextView\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:text=\"Người theo dõi\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:textSize=\"12dp\"\r\n                            android:layout_marginLeft=\"5dp\"\r\n                            android:layout_gravity=\"center\"\r\n                            />\r\n\r\n                    </LinearLayout>\r\n\r\n                    <LinearLayout\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginTop=\"10dp\"\r\n                        >\r\n\r\n                        <TextView\r\n                            android:id=\"@+id/tv_edit_account_activity_account\"\r\n                            android:layout_width=\"wrap_content\"\r\n                            android:layout_height=\"wrap_content\"\r\n                            android:text=\"Chỉnh sửa trang cá nhân\"\r\n                            android:textSize=\"12dp\"\r\n                            android:textColor=\"@color/black\"\r\n                            android:layout_gravity=\"center\"\r\n                            android:padding=\"5dp\"\r\n                            android:background=\"@drawable/bg_tv_edit_account\"\r\n                            />\r\n\r\n                        <ImageView\r\n\r\n                            android:id=\"@+id/img_share_acvitity_account\"\r\n                            android:layout_width=\"25dp\"\r\n                            android:layout_height=\"25dp\"\r\n                            android:src=\"@drawable/ic_baseline_more_horiz_24\"\r\n                            android:padding=\"5dp\"\r\n                            android:background=\"@drawable/bg_tv_edit_account\"\r\n                            android:layout_marginLeft=\"10dp\"\r\n                            />\r\n\r\n                    </LinearLayout>\r\n\r\n            </LinearLayout>\r\n\r\n            </LinearLayout>\r\n\r\n            <ImageView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"1dp\"\r\n                android:background=\"@color/gray_1\"\r\n                />\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"vertical\"\r\n                android:padding=\"10dp\"\r\n                android:background=\"@color/white\"\r\n                >\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n\r\n                    >\r\n\r\n                    <ImageView\r\n                        android:layout_width=\"25dp\"\r\n                        android:layout_height=\"25dp\"\r\n                        android:src=\"@drawable/ic_baseline_star_outline_24\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Đánh giá: \"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        android:layout_marginLeft=\"10dp\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/tv_judge_activity_account\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Chưa có đánh giá\"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"5dp\"\r\n                    >\r\n\r\n                    <ImageView\r\n                        android:layout_width=\"25dp\"\r\n                        android:layout_height=\"25dp\"\r\n                        android:src=\"@drawable/ic_baseline_calendar_month_24\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Ngày tham gia: \"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        android:layout_marginLeft=\"10dp\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/tv_participation_date_activity_account\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"1/1/2022\"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:layout_gravity=\"center\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"5dp\"\r\n                    >\r\n\r\n                    <ImageView\r\n                        android:layout_width=\"25dp\"\r\n                        android:layout_height=\"25dp\"\r\n                        android:src=\"@drawable/ic_baseline_location_on_24\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Địa chỉ:  \"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        android:layout_marginLeft=\"10dp\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/tv_location_activity_account\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Chưa cung cấp\"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"5dp\"\r\n                    >\r\n\r\n                    <ImageView\r\n                        android:layout_width=\"25dp\"\r\n                        android:layout_height=\"25dp\"\r\n                        android:src=\"@drawable/ic_baseline_chat_24\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Phản hồi chat: \"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        android:layout_marginLeft=\"10dp\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/tv_feedback_message_activity_account\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Chưa có thông tin\"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"5dp\"\r\n                    >\r\n\r\n                    <ImageView\r\n                        android:layout_width=\"25dp\"\r\n                        android:layout_height=\"25dp\"\r\n                        android:src=\"@drawable/ic_baseline_done_24\"\r\n                        android:background=\"@drawable/bg_tv_edit_account\"\r\n                        android:padding=\"3dp\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Đã cung cấp: \"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        android:layout_marginLeft=\"10dp\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/tv_facebook\"\r\n                        android:layout_width=\"25dp\"\r\n                        android:layout_height=\"25dp\"\r\n                        android:text=\"f\"\r\n                        android:background=\"@drawable/bg_tv_edit_account\"\r\n                        android:gravity=\"center\"\r\n                        android:textStyle=\"bold\"\r\n                        android:textSize=\"20dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/tv_google\"\r\n                        android:layout_width=\"25dp\"\r\n                        android:layout_height=\"25dp\"\r\n                        android:layout_marginLeft=\"5dp\"\r\n                        android:background=\"@drawable/bg_tv_edit_account\"\r\n                        android:gravity=\"center\"\r\n                        android:text=\"G+\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:textSize=\"12dp\"\r\n                        android:textStyle=\"bold\"\r\n                        android:layout_gravity=\"center\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/tv_zalo\"\r\n                        android:layout_width=\"25dp\"\r\n                        android:layout_height=\"25dp\"\r\n                        android:text=\"Zalo\"\r\n                        android:background=\"@drawable/bg_tv_edit_account\"\r\n                        android:gravity=\"center\"\r\n                        android:textStyle=\"normal\"\r\n                        android:textSize=\"8dp\"\r\n                        android:textColor=\"@color/gray_2\"\r\n                        android:layout_gravity=\"center\"\r\n                        android:layout_marginLeft=\"5dp\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n\r\n            </LinearLayout>\r\n            <ImageView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"1dp\"\r\n                android:background=\"@color/gray_1\"\r\n                />\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"vertical\"\r\n                android:background=\"@color/white\"\r\n                android:layout_marginTop=\"10dp\"\r\n                >\r\n                <ImageView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"1dp\"\r\n                    android:background=\"@color/gray_1\"\r\n                    />\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:padding=\"10dp\"\r\n\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Tin đang đăng - \"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"13dp\"\r\n                        android:textStyle=\"bold\"\r\n                        />\r\n                    <TextView\r\n                        android:id=\"@+id/tv_believe_activity_account\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"0\"\r\n                        android:textStyle=\"normal\"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/black\"\r\n                        />\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"tin\"\r\n                        android:textStyle=\"normal\"\r\n                        android:textSize=\"13dp\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:layout_marginLeft=\"5dp\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n                <ImageView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"1dp\"\r\n                    android:background=\"@color/gray_1\"\r\n                    />\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:minHeight=\"150dp\"\r\n                    android:gravity=\"center\"\r\n                    android:orientation=\"vertical\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Bạn chưa có tin đăng nào đang bán\"\r\n                        android:textColor=\"@color/gray_1\"\r\n                        />\r\n\r\n                    <Button\r\n                        android:id=\"@+id/btn_post_news\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:hint=\"Đăng bán ngay!\"\r\n                        android:textColorHint=\"@color/white\"\r\n                        android:textStyle=\"bold\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n                <ImageView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"1dp\"\r\n                    android:background=\"@color/gray_1\"\r\n                    />\r\n\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"vertical\"\r\n                android:background=\"@color/white\"\r\n                android:layout_marginTop=\"10dp\"\r\n                >\r\n                <ImageView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"1dp\"\r\n                    android:background=\"@color/gray_1\"\r\n                    />\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:padding=\"10dp\"\r\n\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Hồ sơ xin việc\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"13dp\"\r\n                        android:textStyle=\"bold\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n                <ImageView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"1dp\"\r\n                    android:background=\"@color/gray_1\"\r\n                    />\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:minHeight=\"150dp\"\r\n                    android:gravity=\"center\"\r\n                    android:orientation=\"vertical\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Bạn chưa CV. Tạo CV ngay nhé!\"\r\n                        android:textColor=\"@color/gray_1\"\r\n                        />\r\n\r\n                    <Button\r\n                        android:id=\"@+id/btn_job_application\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:hint=\"Tạo hồ sơ xin việc!\"\r\n                        android:textColorHint=\"@color/white\"\r\n                        android:textStyle=\"bold\"\r\n                        />\r\n                </LinearLayout>\r\n                <ImageView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"1dp\"\r\n                    android:background=\"@color/gray_1\"\r\n                    />\r\n\r\n            </LinearLayout>\r\n        </LinearLayout>\r\n    </ScrollView>\r\n</LinearLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_account.xml b/app/src/main/res/layout/activity_account.xml
--- a/app/src/main/res/layout/activity_account.xml	(revision b92f36320a6a42b3f731d4598ab9b06018460d63)
+++ b/app/src/main/res/layout/activity_account.xml	(date 1669987374500)
@@ -26,10 +26,9 @@
             />
 
         <TextView
-            android:id="@+id/username_activity_account"
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
-            android:text="Username"
+            android:text="Thông tin tài khoản"
             android:layout_marginLeft="30dp"
             android:textStyle="bold"
             android:textSize="18dp"
Index: app/src/main/java/com/example/duan1/Login.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.duan1;\r\n\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.app.ProgressDialog;\r\nimport android.content.Intent;\r\nimport android.graphics.Color;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\n\r\nimport android.os.PersistableBundle;\r\nimport android.text.Editable;\r\nimport android.text.TextUtils;\r\nimport android.text.TextWatcher;\r\nimport android.util.Patterns;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.duan1.model.Users;\r\nimport com.facebook.CallbackManager;\r\nimport com.facebook.FacebookCallback;\r\nimport com.facebook.FacebookException;\r\nimport com.facebook.login.LoginManager;\r\nimport com.facebook.login.LoginResult;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInClient;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions;\r\nimport com.google.android.gms.common.api.ApiException;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.AuthResult;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Arrays;\r\nimport java.util.List;\r\n\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\n\r\n\r\npublic class Login extends AppCompatActivity {\r\n\r\n    private static final int RC_SIGN_IN = 1000;\r\n    private ImageView imgBack;\r\n    private CircleImageView imgLoginFacebook, imgLoginGoole, imgLoginZalo;\r\n    private TextView tvResetPassword, tvRegister;\r\n    private EditText edtNumberPhone, edtPassword;\r\n    private Button btnLogin;\r\n\r\n    private FirebaseAuth mAuth;\r\n    private CallbackManager callbackManager;\r\n    private GoogleSignInClient mGoogleSignInClient;\r\n    private GoogleSignInOptions gso;\r\n\r\n    @Override\r\n    public void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_login);\r\n        initUi();\r\n\r\n        //login Facebook\r\n        callbackManager = CallbackManager.Factory.create();\r\n        LoginManager.getInstance().registerCallback(callbackManager,\r\n                new FacebookCallback<LoginResult>() {\r\n                    @Override\r\n                    public void onSuccess(LoginResult loginResult) {\r\n                        Toast.makeText(Login.this, \"Đăng nhập thành công!\", Toast.LENGTH_SHORT).show();\r\n                        Intent intent = new Intent(Login.this, MainActivity.class);\r\n                        setResult(RESULT_OK,intent );\r\n                        finish();\r\n                    }\r\n\r\n                    @Override\r\n                    public void onCancel() {\r\n                        // App code\r\n                    }\r\n\r\n                    @Override\r\n                    public void onError(FacebookException exception) {\r\n                        // App code\r\n                    }\r\n                });\r\n\r\n        //login Goolgle\r\n        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\r\n                .requestEmail()\r\n                .build();\r\n        mGoogleSignInClient = GoogleSignIn.getClient(this, gso);\r\n\r\n        initListenerClick();\r\n        initListenerTextChange();\r\n\r\n\r\n    }\r\n\r\n\r\n\r\n    private void initUi() {\r\n        imgBack = findViewById(R.id.img_back);\r\n        imgLoginFacebook = findViewById(R.id.img_login_facebook);\r\n        imgLoginGoole = findViewById(R.id.img_login_google);\r\n        imgLoginZalo = findViewById(R.id.img_login_zalo);\r\n        tvResetPassword = findViewById(R.id.tv_reset_password);\r\n        tvRegister = findViewById(R.id.tv_register);\r\n        edtNumberPhone = findViewById(R.id.edt_numberphone);\r\n        edtPassword = findViewById(R.id.edt_password);\r\n        btnLogin = findViewById(R.id.btn_login);\r\n\r\n        // Initialize Firebase Auth\r\n        mAuth = FirebaseAuth.getInstance();\r\n\r\n    }\r\n\r\n    private void initListenerClick() {\r\n        //click back\r\n        imgBack.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code back\r\n                finish();\r\n            }\r\n        });\r\n\r\n        //click login facebook\r\n        imgLoginFacebook.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code login facebook\r\n                LoginManager.getInstance().logInWithReadPermissions(Login.this, Arrays.asList(\"public_profile\"));\r\n            }\r\n        });\r\n\r\n        //click login google\r\n        imgLoginGoole.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code login google\r\n                LoginGoogle();\r\n            }\r\n        });\r\n\r\n        //click login zalo\r\n        imgLoginZalo.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code login zalo\r\n                Toast.makeText(Login.this, \"Login zalo from Login\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        //click reset password\r\n        tvResetPassword.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code reset password\r\n                Toast.makeText(Login.this, \"reset Password from Login\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        //click register\r\n        tvRegister.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code register\r\n                startActivity(new Intent(Login.this, Register.class));\r\n            }\r\n        });\r\n\r\n\r\n\r\n    }\r\n\r\n    private void initListenerTextChange() {\r\n        edtNumberPhone.addTextChangedListener(new TextWatcher() {\r\n            @Override\r\n            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void afterTextChanged(Editable editable) {\r\n                if (edtNumberPhone.getText().toString().trim().equals(\"\") || edtPassword.getText().toString().trim().equals(\"\")){\r\n                    btnLogin.setBackgroundResource(R.drawable.bg_button_login);\r\n                    return;\r\n                }else{\r\n                    btnLogin.setBackgroundResource(R.drawable.bg_button_register);\r\n                    OnLogin();\r\n                }\r\n            }\r\n        });\r\n\r\n        edtPassword.addTextChangedListener(new TextWatcher() {\r\n            @Override\r\n            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n\r\n            @Override\r\n            public void afterTextChanged(Editable editable) {\r\n                if (edtNumberPhone.getText().toString().trim().equals(\"\") || edtPassword.getText().toString().trim().equals(\"\")){\r\n                    btnLogin.setBackgroundResource(R.drawable.bg_button_login);\r\n                    return;\r\n                }else{\r\n                    btnLogin.setBackgroundResource(R.drawable.bg_button_register);\r\n                    OnLogin();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    public static boolean isValidEmail(CharSequence target) {\r\n        return (!TextUtils.isEmpty(target) && Patterns.EMAIL_ADDRESS.matcher(target).matches());\r\n    }\r\n\r\n    private void OnLogin(){\r\n\r\n        //click login\r\n        btnLogin.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code login\r\n                ProgressDialog progressDialog = new ProgressDialog(Login.this);\r\n                String email = edtNumberPhone.getText().toString().trim();\r\n                if (!isValidEmail(email)){\r\n                    edtNumberPhone.setError(\"Email không đúng!\");\r\n                    return;\r\n                }\r\n                String password = edtPassword.getText().toString().trim();\r\n                if (password.length() < 6 ){\r\n                    edtPassword.setError(\"Mật khẩu phải bằng hoặc trên 6 kí tự\");\r\n                    return;\r\n                }\r\n\r\n                progressDialog.setTitle(\"Xin chờ\");\r\n                progressDialog.show();\r\n\r\n                mAuth.signInWithEmailAndPassword(email, password)\r\n                        .addOnCompleteListener(Login.this, new OnCompleteListener<AuthResult>() {\r\n                            @Override\r\n                            public void onComplete(@NonNull Task<AuthResult> task) {\r\n\r\n                                Handler handler = new Handler();\r\n                                handler.postDelayed(new Runnable() {\r\n                                    @Override\r\n                                    public void run() {\r\n\r\n                                        if (task.isSuccessful()) {\r\n                                            // Sign in success, update UI with the signed-in user's information\r\n                                            List<Users> mListUser = new ArrayList<>();\r\n                                            FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n                                            DatabaseReference myRef = database.getReference(\"Users\");\r\n                    \r\n                                            myRef.addValueEventListener(new ValueEventListener() {\r\n                                                @Override\r\n                                                public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                                                    mListUser.clear();\r\n                                                    for (DataSnapshot snapshot1 : snapshot.getChildren()){\r\n                                                        Users user = snapshot1.getValue(Users.class);\r\n                                                        mListUser.add(user);\r\n\r\n                                                    }\r\n                                                    for (int i = 0; i < mListUser.size(); i++){\r\n                                                        if (mListUser.get(i).getEmail().equals(email) && mListUser.get(i).getPassword().equals(password)){\r\n                                                            Toast.makeText(Login.this, \"Đăng nhập thành công!\", Toast.LENGTH_SHORT).show();\r\n                                                            Intent intent = new Intent(Login.this, MainActivity.class);\r\n                                                            setResult(RESULT_OK,intent );\r\n                                                            finish();\r\n\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n\r\n                                                @Override\r\n                                                public void onCancelled(@NonNull DatabaseError error) {\r\n                                                    FirebaseAuth.getInstance().signOut();\r\n                                                    Toast.makeText(Login.this, \"Đăng nhập thất bại!\", Toast.LENGTH_SHORT).show();\r\n                                                }\r\n                                            });\r\n//                                            int dem = 0;\r\n//\r\n//                                            if (dem == 0){\r\n//                                                Toast.makeText(Login.this, \"Đăng nhập thất bại!\", Toast.LENGTH_SHORT).show();\r\n//                                            }\r\n                                        } else {\r\n                                            // If sign in fails, display a message to the user.\r\n                                            Toast.makeText(Login.this, \"Đăng nhập thất bại, tài khoản hoặc mật khẩu không đúng!\", Toast.LENGTH_SHORT).show();\r\n                                        }\r\n                                        progressDialog.dismiss();\r\n                                    }\r\n                                },2000);\r\n                            }\r\n                        });\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    private void LoginGoogle() {\r\n        Intent signInIntent = mGoogleSignInClient.getSignInIntent();\r\n        startActivityForResult(signInIntent, RC_SIGN_IN);\r\n    }\r\n\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        // Pass the activity result back to the Facebook SDK\r\n        callbackManager.onActivityResult(requestCode, resultCode, data);\r\n\r\n        //google\r\n        if (requestCode == RC_SIGN_IN) {\r\n            Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);\r\n            try {\r\n                task.getResult(ApiException.class);\r\n                Toast.makeText(Login.this, \"Đăng nhập thành công!\", Toast.LENGTH_SHORT).show();\r\n                Intent intent = new Intent(Login.this, MainActivity.class);\r\n                setResult(RESULT_OK,intent);\r\n                finish();\r\n            } catch (ApiException e) {\r\n                Toast.makeText(this, \"signInResult:failed code=\" + e.getStatusCode(), Toast.LENGTH_SHORT).show();\r\n            }\r\n        }\r\n    }\r\n\r\n    @Override\r\n    protected void onStart() {\r\n        super.onStart();\r\n        GoogleSignInAccount account = GoogleSignIn.getLastSignedInAccount(this);\r\n        if (account != null){\r\n            finish();\r\n        }\r\n\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/duan1/Login.java b/app/src/main/java/com/example/duan1/Login.java
--- a/app/src/main/java/com/example/duan1/Login.java	(revision b92f36320a6a42b3f731d4598ab9b06018460d63)
+++ b/app/src/main/java/com/example/duan1/Login.java	(date 1669982358867)
@@ -283,6 +283,18 @@
                                                         mListUser.add(user);
 
                                                     }
+                                                }
+
+                                                @Override
+                                                public void onCancelled(@NonNull DatabaseError error) {
+                                                    FirebaseAuth.getInstance().signOut();
+                                                    Toast.makeText(Login.this, "Đăng nhập thất bại!", Toast.LENGTH_SHORT).show();
+                                                }
+                                            });
+
+                                            handler.postDelayed(new Runnable() {
+                                                @Override
+                                                public void run() {
                                                     for (int i = 0; i < mListUser.size(); i++){
                                                         if (mListUser.get(i).getEmail().equals(email) && mListUser.get(i).getPassword().equals(password)){
                                                             Toast.makeText(Login.this, "Đăng nhập thành công!", Toast.LENGTH_SHORT).show();
@@ -293,18 +305,9 @@
                                                         }
                                                     }
                                                 }
+                                            },1500);
 
-                                                @Override
-                                                public void onCancelled(@NonNull DatabaseError error) {
-                                                    FirebaseAuth.getInstance().signOut();
-                                                    Toast.makeText(Login.this, "Đăng nhập thất bại!", Toast.LENGTH_SHORT).show();
-                                                }
-                                            });
-//                                            int dem = 0;
-//
-//                                            if (dem == 0){
-//                                                Toast.makeText(Login.this, "Đăng nhập thất bại!", Toast.LENGTH_SHORT).show();
-//                                            }
+
                                         } else {
                                             // If sign in fails, display a message to the user.
                                             Toast.makeText(Login.this, "Đăng nhập thất bại, tài khoản hoặc mật khẩu không đúng!", Toast.LENGTH_SHORT).show();
Index: app/src/main/java/com/example/duan1/Register.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\r\npackage com.example.duan1;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\n\r\nimport android.annotation.SuppressLint;\r\nimport android.app.ProgressDialog;\r\nimport android.content.Intent;\r\nimport android.os.Bundle;\r\nimport android.os.Handler;\r\n\r\n\r\nimport android.text.Editable;\r\nimport android.text.TextUtils;\r\nimport android.text.TextWatcher;\r\nimport android.util.Patterns;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\n\r\nimport com.example.duan1.model.Users;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.AuthResult;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\n\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Collections;\r\nimport java.util.List;\r\n\r\nimport de.hdodenhof.circleimageview.CircleImageView;\r\n\r\npublic class Register extends AppCompatActivity {\r\n\r\n    private ImageView imgBack;\r\n\r\n    private TextView tvTermsAndUse, tvLogin ;\r\n    private EditText edtNumberPhone, edtPassword;\r\n    private Button btnRegister;\r\n\r\n    private ProgressDialog progressDialog;\r\n    private FirebaseAuth mAuth;\r\n\r\n\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_register);\r\n        initUi();\r\n        initListenerClick();\r\n\r\n    }\r\n\r\n    public static boolean isValidEmail(CharSequence target) {\r\n        return (!TextUtils.isEmpty(target) && Patterns.EMAIL_ADDRESS.matcher(target).matches());\r\n    }\r\n\r\n  private void initUi() {\r\n        imgBack = findViewById(R.id.img_back_register);\r\n        tvLogin = findViewById(R.id.tv_login);\r\n        tvTermsAndUse = findViewById(R.id.tv_terms_of_use);\r\n        edtNumberPhone = findViewById(R.id.edt_numberphone_register);\r\n        edtPassword = findViewById(R.id.edt_password_register);\r\n        btnRegister = findViewById(R.id.btn_register);\r\n\r\n        // Initialize Firebase Auth\r\n        mAuth = FirebaseAuth.getInstance();\r\n        progressDialog = new ProgressDialog(this);\r\n    }\r\n\r\n    private void initListenerClick(){\r\n\r\n        //click back\r\n        imgBack.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code back\r\n                finish();\r\n            }\r\n        });\r\n\r\n        //click reset password\r\n        tvTermsAndUse.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code reset password\r\n                Toast.makeText(Register.this, \"Terms and use from Login\", Toast.LENGTH_SHORT).show();\r\n\r\n            }\r\n        });\r\n\r\n        //click login\r\n        tvLogin.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code register\r\n                finish();\r\n            }\r\n        });\r\n\r\n        edtNumberPhone.addTextChangedListener(new TextWatcher() {\r\n            @Override\r\n            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n            @Override\r\n            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n            @Override\r\n            public void afterTextChanged(Editable editable) {\r\n                if (edtNumberPhone.getText().toString().trim().equals(\"\") || edtPassword.getText().toString().trim().equals(\"\")){\r\n                    btnRegister.setBackgroundResource(R.drawable.bg_button_login);\r\n                    return;\r\n                }else{\r\n                    btnRegister.setBackgroundResource(R.drawable.bg_button_register);\r\n                    //code register\r\n                    OnRegister(getListData());\r\n                }\r\n            }\r\n        });\r\n\r\n        edtPassword.addTextChangedListener(new TextWatcher() {\r\n            @Override\r\n            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n            @Override\r\n            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {\r\n\r\n            }\r\n            @Override\r\n            public void afterTextChanged(Editable editable) {\r\n                if (edtNumberPhone.getText().toString().trim().equals(\"\") || edtPassword.getText().toString().trim().equals(\"\")){\r\n                    btnRegister.setBackgroundResource(R.drawable.bg_button_login);\r\n                    return;\r\n                }else{\r\n                    btnRegister.setBackgroundResource(R.drawable.bg_button_register);\r\n                    //code Register\r\n                    OnRegister(getListData());\r\n                }\r\n            }\r\n        });\r\n\r\n        tvTermsAndUse.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code terms of use\r\n                Toast.makeText(Register.this, \"Terms of use from register\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    private void OnRegister(List<Users> listUsers){\r\n\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference();\r\n\r\n\r\n        //click register\r\n        btnRegister.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //code register\r\n                String email = edtNumberPhone.getText().toString().trim();\r\n//                if (isValidEmail(email)){\r\n//                    edtNumberPhone.setError(\"Email không được để trống!\");\r\n//                    return;\r\n//                }\r\n                String password = edtPassword.getText().toString().trim();\r\n                if (password.length() < 6 ){\r\n                    edtPassword.setError(\"Mật khẩu phải bằng hoặc trên 6 kí tự\");\r\n                    return;\r\n                }\r\n                progressDialog.setTitle(\"Xin chờ!\");\r\n                progressDialog.show();\r\n                mAuth.createUserWithEmailAndPassword(email, password)\r\n                        .addOnCompleteListener(Register.this, new OnCompleteListener<AuthResult>() {\r\n                            @Override\r\n                            public void onComplete(@NonNull Task<AuthResult> task) {\r\n                                Handler handler = new Handler();\r\n                                handler.postDelayed(new Runnable() {\r\n                                    @Override\r\n                                    public void run() {\r\n                                        progressDialog.dismiss();\r\n                                        if (task.isSuccessful()) {\r\n                                            // Sign in success, update UI with the signed-in user's information\r\n\r\n                                            int size = listUsers.size();\r\n                                            int IDcuoi = -1;\r\n                                            if (size != 0){\r\n                                                IDcuoi = listUsers.get(size-1).getId();\r\n                                            }\r\n\r\n                                            Users users = new Users(IDcuoi+1, \" \", email, \" \", \" \", password);\r\n                                            myRef.child(\"Users/\"+(IDcuoi+1)).setValue(users);\r\n                                            Toast.makeText(Register.this, \"Tạo tài khoản thành công!\", Toast.LENGTH_SHORT).show();\r\n                                            finish();\r\n                                        } else {\r\n                                            Toast.makeText(Register.this, \"Tạo tài khoản thất bại!.\",Toast.LENGTH_SHORT).show();\r\n                                        }\r\n                                    }\r\n                                },2000);\r\n                            }\r\n                        });\r\n\r\n            }\r\n        });\r\n    }\r\n\r\n    private List<Users> getListData() {\r\n        List<Users> list  = new ArrayList<>();\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference(\"Users\");\r\n        myRef.addValueEventListener(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                list.clear();\r\n                for (DataSnapshot snapshot1 : snapshot.getChildren() ){\r\n                    Users users = snapshot1.getValue(Users.class);\r\n                    list.add(users);\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n                Toast.makeText(Register.this, \"Tải thông tin tài khoản thất bại!\", Toast.LENGTH_SHORT).show();\r\n            }\r\n        });\r\n\r\n        return list;\r\n    }\r\n}\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/duan1/Register.java b/app/src/main/java/com/example/duan1/Register.java
--- a/app/src/main/java/com/example/duan1/Register.java	(revision b92f36320a6a42b3f731d4598ab9b06018460d63)
+++ b/app/src/main/java/com/example/duan1/Register.java	(date 1669989554890)
@@ -3,26 +3,18 @@
 
 import androidx.annotation.NonNull;
 import androidx.appcompat.app.AppCompatActivity;
-
-import android.annotation.SuppressLint;
 import android.app.ProgressDialog;
-import android.content.Intent;
 import android.os.Bundle;
 import android.os.Handler;
-
-
 import android.text.Editable;
 import android.text.TextUtils;
 import android.text.TextWatcher;
-import android.util.Patterns;
 import android.view.View;
 import android.widget.Button;
 import android.widget.EditText;
 import android.widget.ImageView;
 import android.widget.TextView;
 import android.widget.Toast;
-
-
 import com.example.duan1.model.Users;
 import com.google.android.gms.tasks.OnCompleteListener;
 import com.google.android.gms.tasks.Task;
@@ -33,20 +25,17 @@
 import com.google.firebase.database.DatabaseReference;
 import com.google.firebase.database.FirebaseDatabase;
 import com.google.firebase.database.ValueEventListener;
-
-
 import java.util.ArrayList;
-import java.util.Collections;
 import java.util.List;
+import java.util.regex.Pattern;
 
-import de.hdodenhof.circleimageview.CircleImageView;
 
 public class Register extends AppCompatActivity {
 
     private ImageView imgBack;
 
     private TextView tvTermsAndUse, tvLogin ;
-    private EditText edtNumberPhone, edtPassword;
+    private EditText edtNumberPhone, edtPassword, edtName;
     private Button btnRegister;
 
     private ProgressDialog progressDialog;
@@ -64,7 +53,9 @@
     }
 
     public static boolean isValidEmail(CharSequence target) {
-        return (!TextUtils.isEmpty(target) && Patterns.EMAIL_ADDRESS.matcher(target).matches());
+        return (!TextUtils.isEmpty(target) && Pattern.
+                compile("^[A-Za-z0-9]+[A-Za-z0-9]*@[A-Za-z0-9]+(\\\\.[A-Za-z0-9]+)$").
+                matcher(target).matches());
     }
 
   private void initUi() {
@@ -73,6 +64,7 @@
         tvTermsAndUse = findViewById(R.id.tv_terms_of_use);
         edtNumberPhone = findViewById(R.id.edt_numberphone_register);
         edtPassword = findViewById(R.id.edt_password_register);
+        edtName = findViewById(R.id.edt_name_register);
         btnRegister = findViewById(R.id.btn_register);
 
         // Initialize Firebase Auth
@@ -110,6 +102,30 @@
             }
         });
 
+        edtName.addTextChangedListener(new TextWatcher() {
+            @Override
+            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {
+
+            }
+            @Override
+            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
+
+            }
+            @Override
+            public void afterTextChanged(Editable editable) {
+                if (edtNumberPhone.getText().toString().trim().isEmpty() ||
+                        edtPassword.getText().toString().trim().isEmpty() ||
+                        edtName.getText().toString().trim().isEmpty()){
+                    btnRegister.setBackgroundResource(R.drawable.bg_button_login);
+                    return;
+                }else{
+                    btnRegister.setBackgroundResource(R.drawable.bg_button_register);
+                    //code register
+                    OnRegister(getListData());
+                }
+            }
+        });
+
         edtNumberPhone.addTextChangedListener(new TextWatcher() {
             @Override
             public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {
@@ -121,7 +137,9 @@
             }
             @Override
             public void afterTextChanged(Editable editable) {
-                if (edtNumberPhone.getText().toString().trim().equals("") || edtPassword.getText().toString().trim().equals("")){
+                if (edtNumberPhone.getText().toString().trim().isEmpty() ||
+                        edtPassword.getText().toString().trim().isEmpty() ||
+                        edtName.getText().toString().trim().isEmpty()){
                     btnRegister.setBackgroundResource(R.drawable.bg_button_login);
                     return;
                 }else{
@@ -143,7 +161,9 @@
             }
             @Override
             public void afterTextChanged(Editable editable) {
-                if (edtNumberPhone.getText().toString().trim().equals("") || edtPassword.getText().toString().trim().equals("")){
+                if (edtNumberPhone.getText().toString().trim().isEmpty() ||
+                        edtPassword.getText().toString().trim().isEmpty() ||
+                        edtName.getText().toString().trim().isEmpty()){
                     btnRegister.setBackgroundResource(R.drawable.bg_button_login);
                     return;
                 }else{
@@ -175,45 +195,67 @@
             @Override
             public void onClick(View view) {
                 //code register
+                String name = edtName.getText().toString().trim();
+                if (name.isEmpty() || edtName == null){
+                    edtName.setError("Tên không được để trống");
+                    return;
+                }
                 String email = edtNumberPhone.getText().toString().trim();
-//                if (isValidEmail(email)){
-//                    edtNumberPhone.setError("Email không được để trống!");
-//                    return;
-//                }
+                if (isValidEmail(email)){
+                    edtNumberPhone.setError("Email không đúng!");
+                    return;
+                }
                 String password = edtPassword.getText().toString().trim();
                 if (password.length() < 6 ){
                     edtPassword.setError("Mật khẩu phải bằng hoặc trên 6 kí tự");
                     return;
                 }
-                progressDialog.setTitle("Xin chờ!");
+                progressDialog.setTitle("Xin chờ...!");
                 progressDialog.show();
                 mAuth.createUserWithEmailAndPassword(email, password)
                         .addOnCompleteListener(Register.this, new OnCompleteListener<AuthResult>() {
                             @Override
                             public void onComplete(@NonNull Task<AuthResult> task) {
-                                Handler handler = new Handler();
-                                handler.postDelayed(new Runnable() {
-                                    @Override
-                                    public void run() {
-                                        progressDialog.dismiss();
-                                        if (task.isSuccessful()) {
-                                            // Sign in success, update UI with the signed-in user's information
+
+                                if (task.isSuccessful()) {
+                                    Handler handler = new Handler();
+                                    handler.postDelayed(new Runnable() {
+                                        @Override
+                                        public void run() {
+
+                                        // Sign in success, update UI with the signed-in user's information
 
-                                            int size = listUsers.size();
-                                            int IDcuoi = -1;
-                                            if (size != 0){
-                                                IDcuoi = listUsers.get(size-1).getId();
-                                            }
+                                        int size = listUsers.size();
+                                        int IDcuoi = -1;
+                                        if (size != 0){
+                                            IDcuoi = listUsers.get(size-1).getId();
+                                        }
 
-                                            Users users = new Users(IDcuoi+1, " ", email, " ", " ", password);
-                                            myRef.child("Users/"+(IDcuoi+1)).setValue(users);
-                                            Toast.makeText(Register.this, "Tạo tài khoản thành công!", Toast.LENGTH_SHORT).show();
-                                            finish();
-                                        } else {
-                                            Toast.makeText(Register.this, "Tạo tài khoản thất bại!.",Toast.LENGTH_SHORT).show();
-                                        }
-                                    }
-                                },2000);
+                                                Users users = new Users(IDcuoi+1, name, email,
+                                                        " ", " ", password, " ",
+                                                        " ", " ", " ");
+//                                        Users users = new Users(IDcuoi+1, name, email,
+//                                                " ", " ", password);
+
+                                        myRef.child("Users/"+(IDcuoi+1)).setValue(users);
+                                        Toast.makeText(Register.this, "Tạo tài khoản thành công!",
+                                                Toast.LENGTH_SHORT).show();
+                                        finish();
+                                        progressDialog.dismiss();
+                                        }
+                                    },1500);
+
+                                } else {
+                                    Toast.makeText(Register.this, "Tạo tài khoản thất bại!",
+                                            Toast.LENGTH_SHORT).show();
+                                    System.out.println(task.getException());
+                                }
+
+
+
+
+
+
                             }
                         });
 
Index: app/src/main/java/com/example/duan1/Fragment/FragmentThem.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.duan1.Fragment;\r\n\r\nimport static android.app.Activity.RESULT_OK;\r\n\r\nimport static com.facebook.FacebookSdk.getApplicationContext;\r\n\r\nimport android.app.ProgressDialog;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\n\r\nimport androidx.activity.result.ActivityResult;\r\nimport androidx.activity.result.ActivityResultCallback;\r\nimport androidx.activity.result.ActivityResultLauncher;\r\nimport androidx.activity.result.contract.ActivityResultContracts;\r\nimport androidx.annotation.NonNull;\r\nimport androidx.annotation.Nullable;\r\nimport androidx.fragment.app.Fragment;\r\nimport androidx.fragment.app.FragmentManager;\r\nimport androidx.fragment.app.FragmentTransaction;\r\n\r\nimport android.os.Handler;\r\nimport android.util.Log;\r\nimport android.view.LayoutInflater;\r\nimport android.view.MenuItem;\r\nimport android.view.View;\r\nimport android.view.ViewGroup;\r\nimport android.widget.ImageView;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.duan1.Account;\r\nimport com.example.duan1.Login;\r\nimport com.example.duan1.MainActivity;\r\nimport com.example.duan1.R;\r\nimport com.example.duan1.Register;\r\nimport com.example.duan1.model.Users;\r\nimport com.facebook.AccessToken;\r\nimport com.facebook.FacebookSdk;\r\nimport com.facebook.GraphRequest;\r\nimport com.facebook.GraphResponse;\r\nimport com.facebook.login.LoginManager;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInClient;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.android.material.navigation.NavigationView;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\nimport com.google.firebase.storage.FirebaseStorage;\r\nimport com.squareup.picasso.Picasso;\r\n\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.List;\r\n\r\n\r\npublic class FragmentThem extends Fragment implements NavigationView.OnNavigationItemSelectedListener{\r\n\r\n    private ImageView imgLoginRegister;\r\n    private TextView tvEmail;\r\n\r\n    private MainActivity mainActivity;\r\n    private FirebaseAuth mAuth;\r\n    private FirebaseUser currentUser;\r\n    private NavigationView nav;\r\n    private ProgressDialog progressDialog;\r\n    private GoogleSignInClient mGoogleSignInClient;\r\n    private GoogleSignInOptions gso;\r\n    GoogleSignInAccount acct;\r\n\r\n    private ActivityResultLauncher<Intent> mActivityResultLauncher = registerForActivityResult(\r\n            new ActivityResultContracts.StartActivityForResult(), new ActivityResultCallback<ActivityResult>() {\r\n                @Override\r\n                public void onActivityResult(ActivityResult result) {\r\n                    if (result.getResultCode() == RESULT_OK){\r\n                            Restart();\r\n                    }\r\n                }\r\n            });\r\n\r\n    @Override\r\n    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {\r\n        View view = inflater.inflate(R.layout.fragment_them, container, false);\r\n        mainActivity = (MainActivity) getActivity();\r\n        initUi(view);\r\n\r\n        ProgressDialog progressDialog1 = new ProgressDialog(mainActivity);\r\n        progressDialog1.setTitle(\"Đang tải dữ liệu\");\r\n        progressDialog1.show();\r\n        new Handler().postDelayed(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                progressDialog1.dismiss();\r\n            }\r\n        },2500);\r\n\r\n\r\n        nav.setItemIconTintList(null);\r\n        nav.setNavigationItemSelectedListener((NavigationView.OnNavigationItemSelectedListener) this );\r\n\r\n        initListenerClick();\r\n\r\n        return view;\r\n    }\r\n\r\n    private String checkname(String s){\r\n\r\n        if (s.isEmpty()){\r\n            return null;\r\n        }\r\n        String name = \"\";\r\n        if (s.length() > 20){\r\n            for (String s1: s.split(\"\")){\r\n                name+=s1;\r\n                if (name.length() == 30){\r\n                    break;\r\n                }\r\n            };\r\n        }\r\n\r\n        return name+\"...\";\r\n    }\r\n\r\n    private void initUi(View view) {\r\n        imgLoginRegister = view.findViewById(R.id.img_login_register);\r\n        tvEmail = view.findViewById(R.id.tvEmail);\r\n        nav = view.findViewById(R.id.nav_them);\r\n\r\n        progressDialog = new ProgressDialog(mainActivity);\r\n    }\r\n\r\n    private void initListenerClick() {\r\n        imgLoginRegister.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //check đã đăng nhập hay chưa\r\n                currentUser = mAuth.getCurrentUser();\r\n                // Check if user is signed in (non-null) and update UI accordingly.\r\n                AccessToken accessToken = AccessToken.getCurrentAccessToken();\r\n                boolean isLoggedIn = accessToken != null && !accessToken.isExpired();\r\n\r\n                if(currentUser != null || isLoggedIn || acct != null){\r\n                    startActivity(new Intent(mainActivity, Account.class));\r\n                }else {\r\n                    startActivity(new Intent(mainActivity, Login.class));\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    @Override\r\n    public boolean onNavigationItemSelected(@NonNull MenuItem item) {\r\n\r\n        int id = item.getItemId();\r\n\r\n        if(id == R.id.logout){\r\n\r\n            progressDialog.setTitle(\"Đang đăng xuất...\");\r\n            progressDialog.show();\r\n            Handler handler = new Handler();\r\n            handler.postDelayed(new Runnable() {\r\n                @Override\r\n                public void run() {\r\n                    progressDialog.dismiss();\r\n                    FirebaseAuth.getInstance().signOut();\r\n                    LoginManager.getInstance().logOut();\r\n                    AccessToken.setCurrentAccessToken(null);\r\n                    mGoogleSignInClient.signOut();\r\n                    Toast.makeText(mainActivity, \"Đăng xuất thành công\", Toast.LENGTH_SHORT).show();\r\n                    Restart();\r\n\r\n                }\r\n            }, 2000);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n    private void Restart(){\r\n        FragmentManager fragmentManager;\r\n        fragmentManager = mainActivity.getSupportFragmentManager();\r\n        FragmentTransaction fragmentTransaction1 = fragmentManager.beginTransaction();\r\n        fragmentTransaction1.replace(R.id.container, new FragmentThem());\r\n        fragmentTransaction1.detach(FragmentThem.this);\r\n        fragmentTransaction1.commit();\r\n    }\r\n\r\n    private void updateUI() {\r\n\r\n        String email = currentUser.getEmail();\r\n        List<Users> mListUser = new ArrayList<>();\r\n        FirebaseDatabase database = FirebaseDatabase.getInstance();\r\n        DatabaseReference myRef = database.getReference(\"Users\");\r\n        myRef.addValueEventListener(new ValueEventListener() {\r\n            @Override\r\n            public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                mListUser.clear();\r\n                for (DataSnapshot snapshot1 : snapshot.getChildren()){\r\n                    Users user = snapshot1.getValue(Users.class);\r\n                    mListUser.add(user);\r\n                }\r\n                for (int i = 0; i < mListUser.size(); i++){\r\n                    if (mListUser.get(i).getEmail().equals(email)){\r\n                        if (mListUser.get(i).getName() == null){\r\n\r\n                        }\r\n                        if (mListUser.get(i).getName().length() > 30){\r\n                            tvEmail.setText(checkname(mListUser.get(i).getName()));\r\n                        }else{\r\n                            tvEmail.setText(mListUser.get(i).getName());\r\n                        }\r\n                        String strImage = mListUser.get(i).getImage().trim();\r\n                        if (strImage.isEmpty()){\r\n                            return;\r\n                        }\r\n                        Picasso.with(mainActivity)\r\n                                .load(strImage)\r\n                                .placeholder(R.drawable.user_icon)\r\n                                .error(R.drawable.user_icon)\r\n                                .into(imgLoginRegister);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n\r\n            @Override\r\n            public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n            }\r\n        });\r\n\r\n\r\n    }\r\n\r\n    private void getProfileUser() {\r\n        AccessToken accessToken = AccessToken.getCurrentAccessToken();\r\n        GraphRequest request = GraphRequest.newMeRequest(\r\n                accessToken,\r\n                new GraphRequest.GraphJSONObjectCallback() {\r\n                    @Override\r\n                    public void onCompleted(JSONObject object, GraphResponse response) {\r\n                                try {\r\n                                    String fullName = object.getString(\"name\");\r\n                                    String image = object.getJSONObject(\"picture\").getJSONObject(\"data\").getString(\"url\");\r\n\r\n                                    Picasso.with(mainActivity)\r\n                                            .load(image)\r\n                                            .placeholder(R.drawable.user_icon)\r\n                                            .error(R.drawable.user_icon)\r\n                                            .into(imgLoginRegister);\r\n                                    if (fullName.length() > 30){\r\n                                        tvEmail.setText(checkname(fullName));\r\n                                    }else{\r\n                                        tvEmail.setText(fullName);\r\n                                    }\r\n\r\n\r\n                                } catch (JSONException e) {\r\n                                    Toast.makeText(mainActivity, \"Lỗi login fb\", Toast.LENGTH_SHORT).show();\r\n                                }\r\n\r\n                    }\r\n                });\r\n\r\n        Bundle parameters = new Bundle();\r\n        parameters.putString(\"fields\", \"id,name,link,picture.type(large)\");\r\n        request.setParameters(parameters);\r\n        request.executeAsync();\r\n    }\r\n\r\n    private void getProfileUserGoogle() {\r\n        String personName = acct.getDisplayName();\r\n        String personEmail = acct.getEmail();\r\n//        String personId = acct.getId();\r\n        String personPhoto = String.valueOf(acct.getPhotoUrl());\r\n        if ((personName+\" (\"+personEmail+\")\").length() > 30 ){\r\n            tvEmail.setText(checkname(personName+\" (\"+personEmail+\")\"));\r\n        }else{\r\n            tvEmail.setText(personName+\" (\"+personEmail+\")\");\r\n        }\r\n\r\n        Picasso.with(mainActivity)\r\n                .load(personPhoto)\r\n                .placeholder(R.drawable.user_icon)\r\n                .error(R.drawable.user_icon)\r\n                .into(imgLoginRegister);\r\n\r\n    }\r\n\r\n    @Override\r\n    public void onStart() {\r\n        super.onStart();\r\n\r\n\r\n        //firebase\r\n        mAuth = FirebaseAuth.getInstance();\r\n        currentUser = mAuth.getCurrentUser();\r\n\r\n        //facebook\r\n        AccessToken accessToken = AccessToken.getCurrentAccessToken();\r\n        boolean isLoggedIn = accessToken != null && !accessToken.isExpired();\r\n        if (isLoggedIn){\r\n            getProfileUser();\r\n        }\r\n\r\n        //firebase\r\n        if (currentUser != null){\r\n            updateUI();\r\n        }\r\n\r\n        //google\r\n        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN).requestEmail().build();\r\n        mGoogleSignInClient = GoogleSignIn.getClient(mainActivity, gso);\r\n        acct = GoogleSignIn.getLastSignedInAccount(mainActivity);\r\n        if (acct != null) {\r\n            getProfileUserGoogle();\r\n        }\r\n\r\n\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/duan1/Fragment/FragmentThem.java b/app/src/main/java/com/example/duan1/Fragment/FragmentThem.java
--- a/app/src/main/java/com/example/duan1/Fragment/FragmentThem.java	(revision b92f36320a6a42b3f731d4598ab9b06018460d63)
+++ b/app/src/main/java/com/example/duan1/Fragment/FragmentThem.java	(date 1669988108514)
@@ -90,26 +90,38 @@
             });
 
     @Override
-    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
+    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
         View view = inflater.inflate(R.layout.fragment_them, container, false);
         mainActivity = (MainActivity) getActivity();
         initUi(view);
+        AccessToken accessToken = AccessToken.getCurrentAccessToken();
+        boolean isLoggedIn = accessToken != null && !accessToken.isExpired();
+        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN).requestEmail().build();
+        mGoogleSignInClient = GoogleSignIn.getClient(mainActivity, gso);
+        acct = GoogleSignIn.getLastSignedInAccount(mainActivity);
 
-        ProgressDialog progressDialog1 = new ProgressDialog(mainActivity);
-        progressDialog1.setTitle("Đang tải dữ liệu");
-        progressDialog1.show();
-        new Handler().postDelayed(new Runnable() {
-            @Override
-            public void run() {
-                progressDialog1.dismiss();
-            }
-        },2500);
-
-
-        nav.setItemIconTintList(null);
-        nav.setNavigationItemSelectedListener((NavigationView.OnNavigationItemSelectedListener) this );
+        if (isLoggedIn || currentUser != null || acct != null){
+            progressDialog.setTitle("Đang tải dữ liệu");
+            progressDialog.show();
+            getDataUser(isLoggedIn);
+            new Handler().postDelayed(new Runnable() {
+                @Override
+                public void run() {
+                    initListenerClick();
+                    progressDialog.dismiss();
+                }
+            },500);
+            nav.setItemIconTintList(null);
+            nav.setNavigationItemSelectedListener((NavigationView.OnNavigationItemSelectedListener) this );
 
-        initListenerClick();
+        }else{
+            getDataUser(isLoggedIn);
+            initListenerClick();
+            nav.setItemIconTintList(null);
+            nav.setNavigationItemSelectedListener((NavigationView.OnNavigationItemSelectedListener) this );
+        }
+
+
 
         return view;
     }
@@ -120,24 +132,27 @@
             return null;
         }
         String name = "";
-        if (s.length() > 20){
+        if (s.length() > 25){
             for (String s1: s.split("")){
                 name+=s1;
-                if (name.length() == 30){
+                if (name.length() == 25){
                     break;
                 }
             };
-        }
-
-        return name+"...";
-    }
+            return name+"...";
+        }
 
+        return s;
+    }
+
     private void initUi(View view) {
         imgLoginRegister = view.findViewById(R.id.img_login_register);
         tvEmail = view.findViewById(R.id.tvEmail);
         nav = view.findViewById(R.id.nav_them);
 
         progressDialog = new ProgressDialog(mainActivity);
+        mAuth = FirebaseAuth.getInstance();
+        currentUser = mAuth.getCurrentUser();
     }
 
     private void initListenerClick() {
@@ -153,7 +168,7 @@
                 if(currentUser != null || isLoggedIn || acct != null){
                     startActivity(new Intent(mainActivity, Account.class));
                 }else {
-                    startActivity(new Intent(mainActivity, Login.class));
+                    mActivityResultLauncher.launch(new Intent(mainActivity, Login.class));
                 }
 
             }
@@ -217,11 +232,7 @@
                         if (mListUser.get(i).getName() == null){
 
                         }
-                        if (mListUser.get(i).getName().length() > 30){
-                            tvEmail.setText(checkname(mListUser.get(i).getName()));
-                        }else{
-                            tvEmail.setText(mListUser.get(i).getName());
-                        }
+                        tvEmail.setText(checkname(mListUser.get(i).getName()));
                         String strImage = mListUser.get(i).getImage().trim();
                         if (strImage.isEmpty()){
                             return;
@@ -245,7 +256,7 @@
 
     }
 
-    private void getProfileUser() {
+    private void getProfileUserFB() {
         AccessToken accessToken = AccessToken.getCurrentAccessToken();
         GraphRequest request = GraphRequest.newMeRequest(
                 accessToken,
@@ -255,18 +266,12 @@
                                 try {
                                     String fullName = object.getString("name");
                                     String image = object.getJSONObject("picture").getJSONObject("data").getString("url");
-
+                                    tvEmail.setText(checkname(fullName));
                                     Picasso.with(mainActivity)
                                             .load(image)
                                             .placeholder(R.drawable.user_icon)
                                             .error(R.drawable.user_icon)
                                             .into(imgLoginRegister);
-                                    if (fullName.length() > 30){
-                                        tvEmail.setText(checkname(fullName));
-                                    }else{
-                                        tvEmail.setText(fullName);
-                                    }
-
 
                                 } catch (JSONException e) {
                                     Toast.makeText(mainActivity, "Lỗi login fb", Toast.LENGTH_SHORT).show();
@@ -284,7 +289,6 @@
     private void getProfileUserGoogle() {
         String personName = acct.getDisplayName();
         String personEmail = acct.getEmail();
-//        String personId = acct.getId();
         String personPhoto = String.valueOf(acct.getPhotoUrl());
         if ((personName+" ("+personEmail+")").length() > 30 ){
             tvEmail.setText(checkname(personName+" ("+personEmail+")"));
@@ -300,20 +304,10 @@
 
     }
 
-    @Override
-    public void onStart() {
-        super.onStart();
-
-
-        //firebase
-        mAuth = FirebaseAuth.getInstance();
-        currentUser = mAuth.getCurrentUser();
-
+    private void getDataUser(boolean isLoggedIn){
         //facebook
-        AccessToken accessToken = AccessToken.getCurrentAccessToken();
-        boolean isLoggedIn = accessToken != null && !accessToken.isExpired();
         if (isLoggedIn){
-            getProfileUser();
+            getProfileUserFB();
         }
 
         //firebase
@@ -322,13 +316,8 @@
         }
 
         //google
-        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN).requestEmail().build();
-        mGoogleSignInClient = GoogleSignIn.getClient(mainActivity, gso);
-        acct = GoogleSignIn.getLastSignedInAccount(mainActivity);
         if (acct != null) {
             getProfileUserGoogle();
         }
-
-
     }
 }
\ No newline at end of file
Index: app/src/main/res/layout/activity_register.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<LinearLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    tools:context=\".Login\"\r\n    android:orientation=\"vertical\"\r\n    >\r\n\r\n    <ScrollView\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"wrap_content\">\r\n        <LinearLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:orientation=\"vertical\"\r\n            >\r\n            <androidx.appcompat.widget.Toolbar\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"60dp\">\r\n\r\n                <ImageView\r\n                    android:id=\"@+id/img_back_register\"\r\n                    android:layout_width=\"40dp\"\r\n                    android:layout_height=\"40dp\"\r\n                    android:src=\"@drawable/ic_back_ios\"\r\n                    android:paddingLeft=\"10dp\"\r\n                    />\r\n\r\n            </androidx.appcompat.widget.Toolbar>\r\n\r\n            <RelativeLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"120dp\"\r\n                android:orientation=\"horizontal\"\r\n                android:paddingHorizontal=\"22dp\"\r\n                >\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_alignParentStart=\"true\"\r\n                    android:layout_alignParentTop=\"true\"\r\n                    android:layout_alignParentBottom=\"true\"\r\n                    android:layout_marginBottom=\"23dp\"\r\n                    android:orientation=\"vertical\"\r\n                    android:layout_marginTop=\"23dp\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"@string/register\"\r\n                        android:textColor=\"@color/Orenge\"\r\n                        android:textSize=\"22dp\"\r\n                        android:textStyle=\"bold\" />\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Tạo tài khoản Chợ Tốt ngay\"\r\n                        android:textSize=\"15dp\" />\r\n\r\n                </LinearLayout>\r\n\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:orientation=\"vertical\"\r\n                    android:layout_alignParentEnd=\"true\"\r\n                    android:layout_alignParentTop=\"true\"\r\n                    >\r\n\r\n                    <ImageView\r\n                        android:layout_width=\"100dp\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:src=\"@drawable/logo_register\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n\r\n            </RelativeLayout>\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:orientation=\"vertical\"\r\n                android:layout_marginTop=\"10dp\"\r\n                android:paddingHorizontal=\"22dp\"\r\n                >\r\n\r\n\r\n\r\n                    <EditText\r\n                        android:id=\"@+id/edt_numberphone_register\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"38dp\"\r\n                        android:inputType=\"textEmailAddress\"\r\n                        android:background=\"@drawable/bg_input\"\r\n                        android:hint=\"Nhập Email của bạn\"\r\n                        android:paddingStart=\"10dp\"\r\n                        android:textSize=\"14dp\"\r\n                        />\r\n\r\n\r\n\r\n\r\n                    <EditText\r\n                        android:id=\"@+id/edt_password_register\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"40dp\"\r\n                        android:inputType=\"textPassword\"\r\n                        android:hint=\"Nhập mật khẩu mới có ít nhất 5 kí tự\"\r\n                        android:layout_marginTop=\"20dp\"\r\n                        android:background=\"@drawable/bg_input\"\r\n                        android:textSize=\"14dp\"\r\n                        android:paddingStart=\"10dp\"\r\n                        />\r\n\r\n\r\n                <Button\r\n                    android:id=\"@+id/btn_register\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"40dp\"\r\n                    app:backgroundTint=\"@null\"\r\n                    android:layout_marginTop=\"40dp\"\r\n                    android:background=\"@drawable/bg_button_login\"\r\n                    android:hint=\"@string/register\"\r\n                    android:textColorHint=\"@color/white\"\r\n                    android:textSize=\"14dp\"\r\n                    />\r\n\r\n                <LinearLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_marginTop=\"10dp\"\r\n                    android:gravity=\"center\"\r\n                    >\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Bằng việc đăng kí, bạn đã đồng ý với \"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"11dp\"\r\n                        />\r\n\r\n                    <TextView\r\n\r\n                        android:id=\"@+id/tv_terms_of_use\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"Điều khoản sử dụng\"\r\n                        android:textColor=\"@color/teal_700\"\r\n                        android:textSize=\"11dp\"\r\n                        />\r\n\r\n                    <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\" của\"\r\n                        android:textColor=\"@color/black\"\r\n                        android:textSize=\"11dp\"\r\n                        />\r\n\r\n                </LinearLayout>\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\" Chợ tốt\"\r\n                    android:textSize=\"11dp\"\r\n                    android:textColor=\"@color/black\"\r\n                    android:layout_gravity=\"center\"\r\n                    />\r\n\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"30dp\"\r\n                android:gravity=\"center\"\r\n                >\r\n\r\n                <TextView\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"Bạn đã có tài khoản?\"\r\n                    />\r\n\r\n                <TextView\r\n                    android:id=\"@+id/tv_login\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\" Đăng nhập\"\r\n                    android:textColor=\"@color/blue\"\r\n                    />\r\n\r\n            </LinearLayout>\r\n\r\n        </LinearLayout>\r\n\r\n    </ScrollView>\r\n\r\n</LinearLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_register.xml b/app/src/main/res/layout/activity_register.xml
--- a/app/src/main/res/layout/activity_register.xml	(revision b92f36320a6a42b3f731d4598ab9b06018460d63)
+++ b/app/src/main/res/layout/activity_register.xml	(date 1669989429354)
@@ -91,7 +91,16 @@
                 android:paddingHorizontal="22dp"
                 >
 
-
+                <EditText
+                    android:id="@+id/edt_name_register"
+                    android:layout_width="match_parent"
+                    android:layout_height="38dp"
+                    android:inputType="textEmailAddress"
+                    android:background="@drawable/bg_input"
+                    android:hint="Nhập tên của bạn"
+                    android:paddingStart="10dp"
+                    android:textSize="14dp"
+                    />
 
                     <EditText
                         android:id="@+id/edt_numberphone_register"
@@ -101,6 +110,7 @@
                         android:background="@drawable/bg_input"
                         android:hint="Nhập Email của bạn"
                         android:paddingStart="10dp"
+                        android:layout_marginTop="20dp"
                         android:textSize="14dp"
                         />
 
